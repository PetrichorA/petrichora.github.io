<!DOCTYPE html><html lang=zh><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><title>题解</title><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/urlib/bin_8@fec99e52afaf34c19d3569d7d7a81cae8e260bc7/62/69/e2/60/6269e2605d44dfe9f8cfc500574cfe837f8da1cf7ccceddf42582b85ae389b3d.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/urlib/bin_8@8c10797495a2d9da828234a90d7875624b632b7f/42/ec/03/78/42ec0378a7ed94202cc94ee90cdf57e5b9c36b3827bcd0b53a17ac2c5de81035.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/urlib/bin_8@92276ad4c3654c248e9cebd425ae9449475274f9/f1/48/fe/a7/f148fea7fcf0699d4f5d6ce9022d6ec9fed380b5b05355df82006d7c6ddb10ac.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/urlib/bin_8@c2cbf7b3ebfe9743283b0a87a580f013ba2b5712/87/26/22/8b/8726228bc63aab1f6298e15d7bfac9d36bc6fc6b393c34ae2e6c58bb752c895a.css><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/PetrichorA/page-648446cf@0.0.1/katex/katex.min.css><script defer src=https://cdn.jsdelivr.net/gh/PetrichorA/page-648446cf@0.0.1/katex/katex.min.js></script></head><body rlt=1> <div id=user_list> <a href=# class="list-group-item active" value=666> 1209060758 ♥10 </a> </div> <div id=layout> <div id=test-editormd-view class="markdown-body editormd-html-preview"> <h3 id=h3--><a name=贪心+预处理 class=reference-link></a><span class="header-link octicon octicon-link"></span>贪心+预处理</h3> <p>首先说一下一个简单的贪心<br>在枚举<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>x</mi> </mrow> <annotation encoding=application/x-tex>x</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>的子树时，相当于枚举<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>x</mi> </mrow> <annotation encoding=application/x-tex>x</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>的因子<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> <mo stretchy=false>(</mo> <mi>y</mi> <mo stretchy=false>!</mo> <mo>=</mo> <mn>1</mn> <mo stretchy=false>)</mo> </mrow> <annotation encoding=application/x-tex>y(y!=1)</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class=mopen>(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class=mclose>!</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span></span></span></span></span><br>再遍历<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mo stretchy=false>(</mo> <mi>x</mi> <mi mathvariant=normal>/</mi> <mi>y</mi> <mo stretchy=false>)</mo> </mrow> <annotation encoding=application/x-tex>(x/y)</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mord>/</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class=mclose>)</span></span></span></span></span>树<br>若<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> </mrow> <annotation encoding=application/x-tex>y</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>不为质数，则<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> </mrow> <annotation encoding=application/x-tex>y</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>必可以拆分成两个大于1的数<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>p</mi> <mo separator=true>,</mo> <mi>q</mi> </mrow> <annotation encoding=application/x-tex>p,q</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span><span class=mpunct>,</span><span class=mspace style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span><br>当<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> <mo>=</mo> <mi>p</mi> </mrow> <annotation encoding=application/x-tex>y=p</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span>或<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> <mo>=</mo> <mi>q</mi> </mrow> <annotation encoding=application/x-tex>y=q</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span>时包含了原树且多了一个节点，肯定有更优方案<br>故我们枚举的<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>y</mi> </mrow> <annotation encoding=application/x-tex>y</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span>必为质数</p> <h4 id=h4-part1-p50><a name=Part1:P50 class=reference-link></a><span class="header-link octicon octicon-link"></span>Part1:P50</h4> <pre class="prettyprint linenums prettyprinted"><ol class=linenums><li class=L0><code><span class=pun>注意到每个数所对应的因子树都是确定的</span></code></li><li class=L1><code><span class=pun>一个数为多颗树的子树，也就是说被询问到多次，即重复子问题</span></code></li><li class=L2><code><span class=pun>检测到</span><span class=pln>DP</span><span class=pun>关键词，于是考虑</span><span class=pln>DP</span></code></li></ol></pre> <p>对于任意一个<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>x</mi> <mo>∈</mo> <mo stretchy=false>[</mo> <mn>1</mn> <mo separator=true>,</mo> <mn>1</mn> <mi>e</mi> <mn>6</mn> <mo stretchy=false>]</mo> </mrow> <annotation encoding=application/x-tex>x\in[1,1e6]</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>∈</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mopen>[</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style="margin-right: 0.166667em;"></span><span class=mord>1</span><span class="mord mathnormal">e</span><span class=mord>6</span><span class=mclose>]</span></span></span></span></span>,所含质因子的个数不超过8个<br>可以先预处理出每个数的质因子，在转移时直接枚举质因子即可 </p> <h4 id=h4-part2-p70><a name=Part2:P70 class=reference-link></a><span class="header-link octicon octicon-link"></span>Part2:P70</h4> <p>一个数的因子不超过<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mn>2</mn> <msqrt> <mi>x</mi> </msqrt> </mrow> <annotation encoding=application/x-tex>2\sqrt x</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1.04em; vertical-align: -0.23972em;"></span><span class=mord>2</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.80028em;"><span class=svg-align style="top: -3em;"><span class=pstrut style="height: 3em;"></span><span class="mord mathnormal" style="padding-left: 0.833em;">x</span></span><span class style="top: -2.76028em;"><span class=pstrut style="height: 3em;"></span><span class=hide-tail style="min-width: 0.853em; height: 1.08em;"><svg width=400em height=1.08em viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> </svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.23972em;"><span class></span></span></span></span></span></span></span></span></span><br>也就是说我们在DP时展开的树不会超过2e6个<br>离散后DP即可 </p> <h4 id=h4-part3-p100><a name=Part3:P100 class=reference-link></a><span class="header-link octicon octicon-link"></span>Part3:P100</h4> <p>对于如此大的数据范围，继续DP显然是不够的<br>然而，对于这类考虑因子的题，每个数的因子情况都不相同<br>显然对于每个数都要单独决策<br>在回顾先前的DP写法，在决策除去哪个质数时,枚举了所有质因数<br>导致DP所展开的树迅速增大，于是继续考虑贪心，直接得出最优的质因数 </p> <p><strong>是删去指数最大的质因数啦</strong></p> <p>证明:<br>设<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>x</mi> <mo>=</mo> <msubsup> <mi>a</mi> <mn>1</mn> <msub> <mi>b</mi> <mn>1</mn> </msub> </msubsup> <mo>⋅</mo> <msubsup> <mi>a</mi> <mn>2</mn> <msub> <mi>b</mi> <mn>2</mn> </msub> </msubsup> <mo>…</mo> <mi mathvariant=normal>.</mi> <mi mathvariant=normal>.</mi> </mrow> <annotation encoding=application/x-tex> x= a_1^{b_1} \cdot a_2^{b_2} ….. </annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 1.19732em; vertical-align: -0.266308em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.931008em;"><span class style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class style="top: -3.1449em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.317314em;"><span class style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class=pstrut style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.143em;"><span class></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.266308em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>⋅</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1.19732em; vertical-align: -0.266308em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.931008em;"><span class style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class style="top: -3.1449em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.317314em;"><span class style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class=pstrut style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.143em;"><span class></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.266308em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.166667em;"></span><span class=minner>…</span><span class=mspace style="margin-right: 0.166667em;"></span><span class=mord>.</span><span class=mord>.</span></span></span></span></span><br>设删除一个<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <msub> <mi>a</mi> <mn>1</mn> </msub> </mrow> <annotation encoding=application/x-tex>a_1</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.58056em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span>的操作在删除<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <msub> <mi>a</mi> <mn>2</mn> </msub> </mrow> <annotation encoding=application/x-tex>a_2</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.58056em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span>后且<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <msub> <mi>b</mi> <mn>1</mn> </msub> <mo>&gt;</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> </mrow> <annotation encoding=application/x-tex>b_1&gt;b_2</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>&gt;</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span>,当前<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>x</mi> </mrow> <annotation encoding=application/x-tex>x</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>的因子总数为<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>t</mi> <mi>o</mi> <mi>t</mi> </mrow> <annotation encoding=application/x-tex>tot</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span></span></span></span></span><br><span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>a</mi> <mi>n</mi> <mi>s</mi> <mo>+</mo> <mo>=</mo> <mi>t</mi> <mi>o</mi> <mi>t</mi> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> <mo>+</mo> <mi>t</mi> <mi>o</mi> <mi>t</mi> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> </mrow> <annotation encoding=application/x-tex>ans+=tot/(b_2+1)\times b_2+tot/(b_2+1)\times b_2/(b_1+1)\times b_1</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class=mord>+</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span><br>若先删除 <span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <msub> <mi>a</mi> <mn>1</mn> </msub> </mrow> <annotation encoding=application/x-tex>a_1</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.58056em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span><br>则有 <span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>a</mi> <mi>n</mi> <mi>s</mi> <mo>+</mo> <mo>=</mo> <mi>t</mi> <mi>o</mi> <mi>t</mi> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <mo>+</mo> <mi>t</mi> <mi>o</mi> <mi>t</mi> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <mi mathvariant=normal>/</mi> <mo stretchy=false>(</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> <mo>+</mo> <mn>1</mn> <mo stretchy=false>)</mo> <mo>×</mo> <msub> <mi>b</mi> <mn>2</mn> </msub> </mrow> <annotation encoding=application/x-tex>ans+=tot/(b_1+1)\times b_1+tot/(b_1+1)\times b_1/(b_2+1)\times b_2</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class=mord>+</span><span class=mspace style="margin-right: 0.277778em;"></span><span class=mrel>=</span><span class=mspace style="margin-right: 0.277778em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mord>/</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>+</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style="margin-right: 0.222222em;"></span><span class=mbin>×</span><span class=mspace style="margin-right: 0.222222em;"></span></span><span class=base><span class=strut style="height: 0.84444em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span><br>显然先删除 <span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <msub> <mi>a</mi> <mn>1</mn> </msub> </mrow> <annotation encoding=application/x-tex>a_1</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.58056em; vertical-align: -0.15em;"></span><span class=mord><span class="mord mathnormal">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style="height: 0.301108em;"><span class style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class=pstrut style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style="height: 0.15em;"><span class></span></span></span></span></span></span></span></span></span></span>的操作对答案贡献更大，且接下来的子树相同 </p> <p>于是就可以预处理出<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mo stretchy=false>[</mo> <mi>A</mi> <mo separator=true>,</mo> <mi>B</mi> <mo stretchy=false>]</mo> </mrow> <annotation encoding=application/x-tex>[A,B]</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mopen>[</span><span class="mord mathnormal">A</span><span class=mpunct>,</span><span class=mspace style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class=mclose>]</span></span></span></span></span>区间内的数的质因数<br>查询时用一个数据结构维护指数的最大值模拟删除即可 </p> <p>关于预处理，只需要在筛<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mn>1</mn> <mi>e</mi> <mn>6</mn> </mrow> <annotation encoding=application/x-tex>1e6</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 0.64444em; vertical-align: 0em;"></span><span class=mord>1</span><span class="mord mathnormal">e</span><span class=mord>6</span></span></span></span></span>以下素数的时候同时像埃氏筛一样循环一遍<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mo stretchy=false>[</mo> <mi>A</mi> <mo separator=true>,</mo> <mi>B</mi> <mo stretchy=false>]</mo> </mrow> <annotation encoding=application/x-tex>[A,B]</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class=mopen>[</span><span class="mord mathnormal">A</span><span class=mpunct>,</span><span class=mspace style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class=mclose>]</span></span></span></span></span>即可<br>时间复杂度<span class=editormd-tex><span class=katex style="font-size: 1.6em;"><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML> <semantics> <mrow> <mi>O</mi> <mo stretchy=false>(</mo> <mi>n</mi> <mi>l</mi> <mi>n</mi> <mo stretchy=false>(</mo> <mi>n</mi> <mo stretchy=false>)</mo> <mo stretchy=false>)</mo> </mrow> <annotation encoding=application/x-tex>O(nln(n))</annotation> </semantics> </math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">n</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mclose>)</span><span class=mclose>)</span></span></span></span></span></p> </div> </div> <div id=pickup> <div class=stars> <span class></span> </div> 点赞 </div> <script src=https://cdn.jsdelivr.net/npm/jquery@1.11.1/dist/jquery.min.js></script> <script src=https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@5c3956355afede3aa3733467597bca655f633bfb/cb/fd/a7/04/cbfda704333e625c39a933935366104bc5f249f563903479697dd65419c9e599.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@1a3cac13704cfb4581eba7c80d6a17a4875a9cb0/aa/4f/fe/8b/aa4ffe8b05ec5c82ef2083556db92978ff71f9cd0cea5aae897439e2d108405a.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@2a96d3cb5dd059f8251854bb7bee8dbe87a1eb3f/e3/a2/a0/14/e3a2a014ef7afae26a46f7f57eda5c04ab5f82aca421c75c09375957a853c2b1.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@2a0687348c9f51a49c83aefd40db290ce3e53806/01/bb/d6/4e/01bbd64ee83ea0e5328a6b76a71ff3c59471e1a4c60238533211908df7160194.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@e5c61235d73fd4ee4325f30a6a7015e41f4135d6/96/82/6e/d5/96826ed596b183c4fa45ac7cc487e9ef04d642a41cc441aa0e37ce9a220fd60a.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@4a1b5def55a106936540236baee7614eed57ab9e/f1/54/b6/33/f154b633352f533fee95c6d97e7094ec9c4e2440455c49a77f4e4942152a680c.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@3125b34f85e0baf93b75e60a0f5ef3ca86584c3d/6c/36/f3/40/6c36f340c28857f77797084c584ec0ba6d4c70943a106eadabf309c0fbf3e647.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@c86c1bdcba6cd97ce63f15c1be5af0b2c8bb440d/fc/48/48/87/fc484887d4277dcb15dd736f66974dc608579c086fc1e2bd3b221ac3e02d529c.js></script> <script src=https://cdn.jsdelivr.net/gh/urlib/bin_8@e610aa8d166e0be7b5687461949ed4ea5dac9989/b3/67/4c/fe/b3674cfe25895038b937b65fd0465f7bcb8f679f4d2898cb83a111f68e38ae47.js></script> <div id=qds style=display:none;></div></body></html>