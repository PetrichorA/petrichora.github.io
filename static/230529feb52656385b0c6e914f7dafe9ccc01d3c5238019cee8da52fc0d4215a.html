<html><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/urlib/bin_8@8f2b2574ce0cc10870e4ae34f76010b44ee6cb88/4a/36/e4/53/4a36e4538ee7dec8cc42f51e43a8862f712f19f7b69957591551a59f7120ff45.css></head><body> <div style=position:absolute;left:50%;margin-left:-297px;top:0px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background01.jpg width=595 height=841></div> <div style=position:absolute;left:135.65px;top:130.88px class=cls_002><span class=cls_002>517 </span><span class=cls_003>编程具体数学初级班之组合数学</span></div> <div style=position:absolute;left:276.12px;top:178.44px class=cls_004><span class=cls_004>吴一岐</span></div> <div style=position:absolute;left:239.82px;top:209.18px class=cls_005><span class=cls_005>2020 </span><span class=cls_004>年</span><span class=cls_005> 5 </span><span class=cls_004>月</span><span class=cls_005> 19 </span><span class=cls_004>日</span> </div> <div style=position:absolute;left:74.41px;top:265.79px class=cls_006><span class=cls_006>1</span> </div> <div style=position:absolute;left:101.32px;top:265.79px class=cls_007><span class=cls_007>前言</span></div> <div style=position:absolute;left:98.32px;top:301.68px class=cls_008><span class=cls_008>组合数学是计算机科学中的重要组成部分</span><span class=cls_009>，</span><span class=cls_008>在信息学竞赛中经常与数论</span><span class=cls_009>，</span><span class=cls_008>概率</span><span class=cls_009>，</span><span class=cls_008>动</span> </div> <div style=position:absolute;left:74.41px;top:320.46px class=cls_008><span class=cls_008>态规划等需要计数的模型一起出现</span></div> <div style=position:absolute;left:98.32px;top:339.24px class=cls_008><span class=cls_008>并且</span><span class=cls_009>，</span><span class=cls_008>在各类复杂度分析</span><span class=cls_009>，</span><span class=cls_008>算法可行性分析</span><span class=cls_009>，</span><span class=cls_008>公式推导中</span><span class=cls_009>，</span><span class=cls_008>组合数学的内容也具有</span></div> <div style=position:absolute;left:74.41px;top:358.02px class=cls_008><span class=cls_008>重要的支撑作用</span><span class=cls_009>，</span><span class=cls_008>因此</span><span class=cls_009>，</span><span class=cls_008>锻炼扎实的组合数学基本功是非常必要的</span><span class=cls_009>！</span> </div> <div style=position:absolute;left:294.71px;top:732.65px class=cls_009><span class=cls_009>1</span> </div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:851px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background02.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_008><span class=cls_008>目录</span> </div> <div style=position:absolute;left:496.96px;top:44.59px class=cls_008><span class=cls_008>目录</span> </div> <div style=position:absolute;left:74.41px;top:78.93px class=cls_007><span class=cls_007>目录</span> </div> <div style=position:absolute;left:74.41px;top:114.92px class=cls_010><span class=cls_010>1</span> </div> <div style=position:absolute;left:92.34px;top:114.92px class=cls_011><span class=cls_011>前言</span> </div> <div style=position:absolute;left:514.14px;top:114.92px class=cls_012><span class=cls_012>1</span> </div> <div style=position:absolute;left:74.41px;top:145.66px class=cls_010><span class=cls_010>2</span> </div> <div style=position:absolute;left:92.34px;top:145.66px class=cls_011><span class=cls_011>常见的一些符号表示的意义</span></div> <div style=position:absolute;left:514.14px;top:145.66px class=cls_012><span class=cls_012>4</span> </div> <div style=position:absolute;left:74.41px;top:176.39px class=cls_010><span class=cls_010>3</span> </div> <div style=position:absolute;left:92.34px;top:176.39px class=cls_011><span class=cls_011>基础知识</span></div> <div style=position:absolute;left:514.14px;top:176.39px class=cls_012><span class=cls_012>5</span> </div> <div style=position:absolute;left:92.34px;top:195.17px class=cls_013><span class=cls_013>3.1</span></div> <div style=position:absolute;left:119.84px;top:195.17px class=cls_011><span class=cls_011>组合数的阶乘表示</span> </div> <div style=position:absolute;left:515.01px;top:195.17px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:92.34px;top:213.95px class=cls_013><span class=cls_013>3.2</span></div> <div style=position:absolute;left:119.84px;top:213.95px class=cls_011><span class=cls_011>递推公式</span> </div> <div style=position:absolute;left:515.01px;top:213.95px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:92.34px;top:232.73px class=cls_013><span class=cls_013>3.3</span></div> <div style=position:absolute;left:119.84px;top:232.73px class=cls_011><span class=cls_011>二项式定理</span> </div> <div style=position:absolute;left:515.01px;top:232.73px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:92.34px;top:251.51px class=cls_013><span class=cls_013>3.4</span></div> <div style=position:absolute;left:119.84px;top:251.51px class=cls_011><span class=cls_011>二项式定理的变形</span> </div> <div style=position:absolute;left:515.01px;top:251.51px class=cls_009><span class=cls_009>6</span> </div> <div style=position:absolute;left:92.34px;top:270.29px class=cls_013><span class=cls_013>3.5</span></div> <div style=position:absolute;left:119.84px;top:270.29px class=cls_011><span class=cls_011>组合数公式常见变形</span> </div> <div style=position:absolute;left:515.01px;top:270.29px class=cls_009><span class=cls_009>6</span> </div> <div style=position:absolute;left:92.34px;top:289.07px class=cls_013><span class=cls_013>3.6</span></div> <div style=position:absolute;left:119.84px;top:289.07px class=cls_011><span class=cls_011>隔板法</span></div> <div style=position:absolute;left:515.01px;top:289.07px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:92.34px;top:307.85px class=cls_013><span class=cls_013>3.7</span></div> <div style=position:absolute;left:119.84px;top:307.85px class=cls_011><span class=cls_011>错位排列</span> </div> <div style=position:absolute;left:515.01px;top:307.85px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:92.34px;top:326.63px class=cls_013><span class=cls_013>3.8</span></div> <div style=position:absolute;left:119.84px;top:326.63px class=cls_011><span class=cls_011>圆排列</span></div> <div style=position:absolute;left:515.01px;top:326.63px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:92.34px;top:345.41px class=cls_013><span class=cls_013>3.9</span></div> <div style=position:absolute;left:119.84px;top:345.41px class=cls_011><span class=cls_011>多重集合的排列</span> </div> <div style=position:absolute;left:515.01px;top:345.41px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:92.34px;top:364.19px class=cls_013><span class=cls_013>3.10</span></div> <div style=position:absolute;left:119.84px;top:364.19px class=cls_011><span class=cls_011>多重集合的组合</span> </div> <div style=position:absolute;left:515.01px;top:364.19px class=cls_009><span class=cls_009>8</span> </div> <div style=position:absolute;left:92.34px;top:382.97px class=cls_013><span class=cls_013>3.11</span></div> <div style=position:absolute;left:119.84px;top:382.97px class=cls_011><span class=cls_011>鸽巢原理</span> </div> <div style=position:absolute;left:515.01px;top:382.97px class=cls_009><span class=cls_009>8</span> </div> <div style=position:absolute;left:119.84px;top:401.75px class=cls_013><span class=cls_013>3.11.1</span> </div> <div style=position:absolute;left:158.10px;top:401.75px class=cls_011><span class=cls_011>普通鸽巢原理</span> </div> <div style=position:absolute;left:515.01px;top:401.75px class=cls_009><span class=cls_009>8</span> </div> <div style=position:absolute;left:119.84px;top:420.53px class=cls_013><span class=cls_013>3.11.2</span> </div> <div style=position:absolute;left:158.10px;top:420.53px class=cls_011><span class=cls_011>加强版鸽巢原理</span> </div> <div style=position:absolute;left:515.01px;top:420.53px class=cls_009><span class=cls_009>8</span> </div> <div style=position:absolute;left:74.41px;top:451.26px class=cls_010><span class=cls_010>4</span> </div> <div style=position:absolute;left:92.34px;top:451.26px class=cls_011><span class=cls_011>康托展开</span></div> <div style=position:absolute;left:514.14px;top:451.26px class=cls_012><span class=cls_012>9</span> </div> <div style=position:absolute;left:92.34px;top:470.04px class=cls_013><span class=cls_013>4.1</span></div> <div style=position:absolute;left:119.84px;top:470.04px class=cls_011><span class=cls_011>计算排列的排名</span> </div> <div style=position:absolute;left:515.01px;top:470.04px class=cls_009><span class=cls_009>9</span> </div> <div style=position:absolute;left:92.34px;top:488.82px class=cls_013><span class=cls_013>4.2</span></div> <div style=position:absolute;left:119.84px;top:488.82px class=cls_011><span class=cls_011>计算特定排名的排列</span> </div> <div style=position:absolute;left:515.01px;top:488.82px class=cls_009><span class=cls_009>9</span> </div> <div style=position:absolute;left:92.34px;top:507.60px class=cls_013><span class=cls_013>4.3</span></div> <div style=position:absolute;left:119.84px;top:507.60px class=cls_011><span class=cls_011>下一个排列</span> </div> <div style=position:absolute;left:515.01px;top:507.60px class=cls_009><span class=cls_009>9</span> </div> <div style=position:absolute;left:74.41px;top:538.33px class=cls_010><span class=cls_010>5</span> </div> <div style=position:absolute;left:92.34px;top:538.33px class=cls_011><span class=cls_011>特殊的数列</span> </div> <div style=position:absolute;left:507.40px;top:538.33px class=cls_012><span class=cls_012>10</span></div> <div style=position:absolute;left:92.34px;top:557.11px class=cls_013><span class=cls_013>5.1</span></div> <div style=position:absolute;left:119.84px;top:557.11px class=cls_011><span class=cls_011>第一类斯特林数</span> </div> <div style=position:absolute;left:509.15px;top:557.11px class=cls_009><span class=cls_009>10</span></div> <div style=position:absolute;left:92.34px;top:575.89px class=cls_013><span class=cls_013>5.2</span></div> <div style=position:absolute;left:119.84px;top:575.89px class=cls_011><span class=cls_011>第二类斯特林数</span> </div> <div style=position:absolute;left:509.15px;top:575.89px class=cls_009><span class=cls_009>10</span></div> <div style=position:absolute;left:92.34px;top:594.67px class=cls_013><span class=cls_013>5.3</span></div> <div style=position:absolute;left:119.84px;top:594.67px class=cls_011><span class=cls_011>卡特兰数</span> </div> <div style=position:absolute;left:509.15px;top:594.67px class=cls_009><span class=cls_009>11</span></div> <div style=position:absolute;left:119.84px;top:613.45px class=cls_013><span class=cls_013>5.3.1</span> </div> <div style=position:absolute;left:158.10px;top:613.45px class=cls_011><span class=cls_011>卡特兰数的其他形式</span> </div> <div style=position:absolute;left:509.15px;top:613.45px class=cls_009><span class=cls_009>12</span></div> <div style=position:absolute;left:119.84px;top:632.23px class=cls_013><span class=cls_013>5.3.2</span> </div> <div style=position:absolute;left:158.10px;top:632.23px class=cls_011><span class=cls_011>卡特兰数的一些应用</span><span class=cls_013> (</span><span class=cls_011>信息学中初赛经常常用到</span><span class=cls_013>)</span></div> <div style=position:absolute;left:509.15px;top:632.23px class=cls_009><span class=cls_009>12</span></div> <div style=position:absolute;left:74.41px;top:662.97px class=cls_010><span class=cls_010>6</span> </div> <div style=position:absolute;left:92.34px;top:662.97px class=cls_011><span class=cls_011>放球问题汇总</span> </div> <div style=position:absolute;left:507.40px;top:662.97px class=cls_012><span class=cls_012>13</span></div> <div style=position:absolute;left:92.34px;top:681.75px class=cls_013><span class=cls_013>6.1</span></div> <div style=position:absolute;left:119.84px;top:681.75px class=cls_011><span class=cls_011>球相同</span><span class=cls_013>, </span><span class=cls_011>盒相同</span><span class=cls_013>, </span><span class=cls_011>可以为空</span></div> <div style=position:absolute;left:509.15px;top:681.75px class=cls_009><span class=cls_009>13</span></div> <div style=position:absolute;left:92.34px;top:700.53px class=cls_013><span class=cls_013>6.2</span></div> <div style=position:absolute;left:119.84px;top:700.53px class=cls_011><span class=cls_011>球相同</span><span class=cls_013>, </span><span class=cls_011>盒相同</span><span class=cls_013>, </span><span class=cls_011>不能为空</span></div> <div style=position:absolute;left:509.15px;top:700.53px class=cls_009><span class=cls_009>13</span></div> <div style=position:absolute;left:294.71px;top:732.65px class=cls_009><span class=cls_009>2</span> </div> <div style=position:absolute;left:427.02px;top:732.65px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:1702px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background03.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_008><span class=cls_008>目录</span> </div> <div style=position:absolute;left:496.96px;top:44.59px class=cls_008><span class=cls_008>目录</span> </div> <div style=position:absolute;left:92.34px;top:85.79px class=cls_013><span class=cls_013>6.3</span> </div> <div style=position:absolute;left:119.84px;top:85.79px class=cls_011><span class=cls_011>球不同</span><span class=cls_013>, </span><span class=cls_011>盒不同</span><span class=cls_013>, </span><span class=cls_011>可以为空</span></div> <div style=position:absolute;left:509.15px;top:85.79px class=cls_009><span class=cls_009>14</span> </div> <div style=position:absolute;left:92.34px;top:104.57px class=cls_013><span class=cls_013>6.4</span></div> <div style=position:absolute;left:119.84px;top:104.57px class=cls_011><span class=cls_011>球不同</span><span class=cls_013>, </span><span class=cls_011>盒相同</span><span class=cls_013>, </span><span class=cls_011>不能为空</span></div> <div style=position:absolute;left:509.15px;top:104.57px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:92.34px;top:123.35px class=cls_013><span class=cls_013>6.5</span></div> <div style=position:absolute;left:119.84px;top:123.35px class=cls_011><span class=cls_011>球不同</span><span class=cls_013>, </span><span class=cls_011>盒不同</span><span class=cls_013>, </span><span class=cls_011>不能为空</span></div> <div style=position:absolute;left:509.15px;top:123.35px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:92.34px;top:142.13px class=cls_013><span class=cls_013>6.6</span></div> <div style=position:absolute;left:119.84px;top:142.13px class=cls_011><span class=cls_011>球不同</span><span class=cls_013>, </span><span class=cls_011>盒相同</span><span class=cls_013>, </span><span class=cls_011>可以为空</span></div> <div style=position:absolute;left:509.15px;top:142.13px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:92.34px;top:160.91px class=cls_013><span class=cls_013>6.7</span></div> <div style=position:absolute;left:119.84px;top:160.91px class=cls_011><span class=cls_011>球相同</span><span class=cls_013>, </span><span class=cls_011>盒不同</span><span class=cls_013>, </span><span class=cls_011>不能为空</span></div> <div style=position:absolute;left:509.15px;top:160.91px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:92.34px;top:179.69px class=cls_013><span class=cls_013>6.8</span></div> <div style=position:absolute;left:119.84px;top:179.69px class=cls_011><span class=cls_011>球相同</span><span class=cls_013>, </span><span class=cls_011>盒不同</span><span class=cls_013>, </span><span class=cls_011>可以为空</span></div> <div style=position:absolute;left:509.15px;top:179.69px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:74.41px;top:210.42px class=cls_010><span class=cls_010>7</span> </div> <div style=position:absolute;left:92.34px;top:210.42px class=cls_011><span class=cls_011>组合数取模</span> </div> <div style=position:absolute;left:507.40px;top:210.42px class=cls_012><span class=cls_012>14</span></div> <div style=position:absolute;left:92.34px;top:229.20px class=cls_013><span class=cls_013>7.1</span></div> <div style=position:absolute;left:119.84px;top:229.20px class=cls_011><span class=cls_011>第一阶段</span><span class=cls_013>-</span><span class=cls_011>普通阶乘逆元</span></div> <div style=position:absolute;left:509.15px;top:229.20px class=cls_009><span class=cls_009>15</span></div> <div style=position:absolute;left:92.34px;top:247.98px class=cls_013><span class=cls_013>7.2</span></div> <div style=position:absolute;left:119.84px;top:247.98px class=cls_011><span class=cls_011>第二阶段</span><span class=cls_013>-</span><span class=cls_011>卢卡斯定理</span></div> <div style=position:absolute;left:509.15px;top:247.98px class=cls_009><span class=cls_009>15</span></div> <div style=position:absolute;left:119.84px;top:266.76px class=cls_013><span class=cls_013>7.2.1</span> </div> <div style=position:absolute;left:158.10px;top:266.76px class=cls_011><span class=cls_011>定理描述</span> </div> <div style=position:absolute;left:509.15px;top:266.76px class=cls_009><span class=cls_009>15</span></div> <div style=position:absolute;left:119.84px;top:285.54px class=cls_013><span class=cls_013>7.2.2</span> </div> <div style=position:absolute;left:158.10px;top:285.54px class=cls_011><span class=cls_011>定理证明</span> </div> <div style=position:absolute;left:509.15px;top:285.54px class=cls_009><span class=cls_009>15</span></div> <div style=position:absolute;left:92.34px;top:304.32px class=cls_013><span class=cls_013>7.3</span></div> <div style=position:absolute;left:119.84px;top:304.32px class=cls_011><span class=cls_011>第三阶段</span><span class=cls_013>-</span><span class=cls_011>中国剩余定理合并</span></div> <div style=position:absolute;left:509.15px;top:304.32px class=cls_009><span class=cls_009>16</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>3</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:2553px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background04.jpg width=595 height=841></div> <div style=position:absolute;left:359.59px;top:44.59px class=cls_009><span class=cls_009>2</span> </div> <div style=position:absolute;left:377.40px;top:44.59px class=cls_008><span class=cls_008>常见的一些符号表示的意义</span></div> <div style=position:absolute;left:74.41px;top:81.81px class=cls_006><span class=cls_006>2</span> </div> <div style=position:absolute;left:101.32px;top:81.81px class=cls_007><span class=cls_007>常见的一些符号表示的意义</span></div> <div style=position:absolute;left:89.21px;top:117.70px class=cls_009><span class=cls_009>1.</span> </div> <div style=position:absolute;left:104.30px;top:117.70px class=cls_014><span class=cls_014>a|b</span><span class=cls_009> </span><span class=cls_008>表示</span><span class=cls_014> a</span><span class=cls_009> </span><span class=cls_008>是</span><span class=cls_014> b</span><span class=cls_009> </span><span class=cls_008>的约数</span></div> <div style=position:absolute;left:89.21px;top:146.45px class=cls_009><span class=cls_009>2.</span> </div> <div style=position:absolute;left:104.30px;top:145.72px class=cls_014><span class=cls_014>⌊</span><span class=cls_015><sup>a</sup></span></div> <div style=position:absolute;left:125.71px;top:146.45px class=cls_009><span class=cls_009>,</span><span class=cls_008> 表示</span><span class=cls_014> a</span><span class=cls_009> </span><span class=cls_008>除以</span><span class=cls_014> b</span><span class=cls_009> </span><span class=cls_008>下取整</span> </div> <div style=position:absolute;left:111.24px;top:146.45px class=cls_015><span class=cls_015>b</span><span class=cls_014>⌋</span></div> <div style=position:absolute;left:105.50px;top:168.55px class=cls_009><span class=cls_009>∏</span> </div> <div style=position:absolute;left:89.21px;top:177.51px class=cls_009><span class=cls_009>3.</span> </div> <div style=position:absolute;left:119.99px;top:177.51px class=cls_014><span class=cls_014>p</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>表示</span><span class=cls_014> p</span><span class=cls_016><sub>1</sub></span><span class=cls_014>,p</span><span class=cls_016><sub>2</sub></span><span class=cls_014>,...,p</span><span class=cls_015><sub>n</sub></span><span class=cls_009> </span><span class=cls_008>的乘积</span></div> <div style=position:absolute;left:104.30px;top:191.75px class=cls_015><span class=cls_015>i</span><span class=cls_016>=1</span></div> <div style=position:absolute;left:104.84px;top:206.93px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:89.21px;top:215.90px class=cls_009><span class=cls_009>4.</span> </div> <div style=position:absolute;left:119.99px;top:215.90px class=cls_014><span class=cls_014>a</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>表示</span><span class=cls_014> a</span><span class=cls_016><sub>1</sub></span><span class=cls_014>,a</span><span class=cls_016><sub>2</sub></span><span class=cls_014>,...,a</span><span class=cls_015><sub>n</sub></span><span class=cls_009> </span><span class=cls_008>的和</span></div> <div style=position:absolute;left:104.30px;top:230.14px class=cls_015><span class=cls_015>i</span><span class=cls_016>=1</span></div> <div style=position:absolute;left:89.21px;top:247.60px class=cls_009><span class=cls_009>5.</span> </div> <div style=position:absolute;left:104.30px;top:247.60px class=cls_014><span class=cls_014>a ≡ b</span><span class=cls_009> (mod </span><span class=cls_014>p</span><span class=cls_009>) </span><span class=cls_008>表示 </span><span class=cls_014>a </span><span class=cls_008>与 </span><span class=cls_014>b </span><span class=cls_008>模 </span><span class=cls_014>p </span><span class=cls_008>的结果是相同的</span></div> <div style=position:absolute;left:104.30px;top:267.37px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:89.21px;top:276.34px class=cls_009><span class=cls_009>6.</span> </div> <div style=position:absolute;left:120.81px;top:276.34px class=cls_008><span class=cls_008>表示枚举</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>的所有因子</span><span class=cls_014> d</span></div> <div style=position:absolute;left:104.68px;top:291.28px class=cls_015><span class=cls_015>d|n</span></div> <div style=position:absolute;left:89.21px;top:310.77px class=cls_009><span class=cls_009>7.</span> </div> <div style=position:absolute;left:104.30px;top:310.77px class=cls_014><span class=cls_014>f × g</span><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009>) </span><span class=cls_008>表示 </span><span class=cls_014>f</span><span class=cls_009> </span><span class=cls_008>函数与 </span><span class=cls_014>g</span><span class=cls_009> </span><span class=cls_008>函数的狄利克雷卷积</span> </div> <div style=position:absolute;left:104.30px;top:329.88px class=cls_009><span class=cls_009>∫</span><span class=cls_015>b</span></div> <div style=position:absolute;left:89.21px;top:339.51px class=cls_009><span class=cls_009>8.</span> </div> <div style=position:absolute;left:109.94px;top:339.51px class=cls_015><span class=cls_015>a</span><span class=cls_014> f</span><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009>)</span><span class=cls_014>dx</span><span class=cls_008>表示定积分</span></div> <div style=position:absolute;left:89.21px;top:368.25px class=cls_009><span class=cls_009>9.</span> </div> <div style=position:absolute;left:104.30px;top:368.25px class=cls_014><span class=cls_014>f</span><span class=cls_009> (</span><span class=cls_014>x</span><span class=cls_009>) = [</span><span class=cls_014>x</span><span class=cls_009> = 1] </span><span class=cls_008>表示</span><span class=cls_014> f</span><span class=cls_009> (</span><span class=cls_014>x</span><span class=cls_009>) </span><span class=cls_008>只有在</span><span class=cls_014> x</span><span class=cls_009> = 1 </span><span class=cls_008>的时候才为</span><span class=cls_009> 1，</span><span class=cls_008>其他情况为</span> </div> <div style=position:absolute;left:453.08px;top:368.25px class=cls_009><span class=cls_009>0</span> </div> <div style=position:absolute;left:104.30px;top:387.31px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:83.35px;top:397.00px class=cls_009><span class=cls_009>10.</span></div> <div style=position:absolute;left:126.64px;top:396.64px class=cls_008><span class=cls_008>与</span><span class=cls_014>C</span><span class=cls_015><sup>m</sup></span></div> <div style=position:absolute;left:109.78px;top:405.10px class=cls_015><span class=cls_015>m</span> </div> <div style=position:absolute;left:150.87px;top:397.00px class=cls_015><span class=cls_015>n</span><span class=cls_009> </span><span class=cls_008>等价</span><span class=cls_009>，</span><span class=cls_008>都表示</span><span class=cls_014>n</span><span class=cls_008>个不同的小球取</span><span class=cls_014>m</span><span class=cls_008>个方案数</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>4</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:3404px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background05.jpg width=595 height=841></div> <div style=position:absolute;left:455.23px;top:44.59px class=cls_009><span class=cls_009>3</span> </div> <div style=position:absolute;left:473.05px;top:44.59px class=cls_008><span class=cls_008>基础知识</span></div> <div style=position:absolute;left:74.41px;top:81.45px class=cls_006><span class=cls_006>3</span> </div> <div style=position:absolute;left:101.32px;top:81.45px class=cls_007><span class=cls_007>基础知识</span></div> <div style=position:absolute;left:74.41px;top:119.48px class=cls_017><span class=cls_017>3.1</span></div> <div style=position:absolute;left:109.40px;top:119.48px class=cls_004><span class=cls_004>组合数的阶乘表示</span> </div> <div style=position:absolute;left:229.32px;top:150.31px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:330.80px;top:159.08px class=cls_014><span class=cls_014>n</span><span class=cls_009>!</span></div> <div style=position:absolute;left:238.12px;top:166.21px class=cls_014><span class=cls_014>m</span><span class=cls_009> =</span><span class=cls_014><sup>C</sup></span><span class=cls_015>n</span><span class=cls_009> =</span></div> <div style=position:absolute;left:307.07px;top:175.36px class=cls_014><span class=cls_014>m</span><span class=cls_009>!(</span><span class=cls_014>n − m</span><span class=cls_009>)!</span></div> <div style=position:absolute;left:74.41px;top:204.83px class=cls_017><span class=cls_017>3.2</span></div> <div style=position:absolute;left:109.40px;top:204.83px class=cls_004><span class=cls_004>递推公式</span> </div> <div style=position:absolute;left:221.96px;top:235.65px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:265.54px;top:235.65px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n−</span><span class=cls_009>1)</span></div> <div style=position:absolute;left:328.27px;top:235.65px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n −</span><span class=cls_009> 1)</span> </div> <div style=position:absolute;left:316.50px;top:252.51px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:230.76px;top:252.51px class=cls_014><span class=cls_014>m</span><span class=cls_009> =</span></div> <div style=position:absolute;left:274.34px;top:260.71px class=cls_014><span class=cls_014>m−</span><span class=cls_009>1</span></div> <div style=position:absolute;left:345.67px;top:260.71px class=cls_014><span class=cls_014>m</span> </div> <div style=position:absolute;left:90.00px;top:284.91px class=cls_018><span class=cls_018>预处理组合数</span> </div> <div style=position:absolute;left:90.00px;top:311.87px class=cls_019><span class=cls_019>const int</span><span class=cls_020> md = ;</span><span class=cls_021> //</span><span class=cls_022>模数</span></div> <div style=position:absolute;left:90.00px;top:329.49px class=cls_019><span class=cls_019>const int</span><span class=cls_020> N = ;</span><span class=cls_021> //</span><span class=cls_022>数组大小</span></div> <div style=position:absolute;left:90.00px;top:347.10px class=cls_019><span class=cls_019>int</span><span class=cls_020> c[N][N];</span></div> <div style=position:absolute;left:90.00px;top:364.72px class=cls_019><span class=cls_019>void</span><span class=cls_020> init() {</span></div> <div style=position:absolute;left:99.82px;top:382.33px class=cls_020><span class=cls_020>c[0][0] = 1;</span></div> <div style=position:absolute;left:99.82px;top:399.94px class=cls_019><span class=cls_019>for</span><span class=cls_020> (</span><span class=cls_019>int</span><span class=cls_020> i = 1; i &lt; N; i++) {</span></div> <div style=position:absolute;left:109.64px;top:417.56px class=cls_020><span class=cls_020>c[i][i] = c[i][0] = 1;</span></div> <div style=position:absolute;left:109.64px;top:435.17px class=cls_019><span class=cls_019>for</span><span class=cls_020> (</span><span class=cls_019>int</span><span class=cls_020> j = 1; j &lt; i; j++) {</span></div> <div style=position:absolute;left:119.46px;top:452.79px class=cls_020><span class=cls_020>c[i][j] = c[i - 1][j] + c[i - 1][j - 1];</span></div> <div style=position:absolute;left:119.46px;top:470.40px class=cls_020><span class=cls_020>c[i][j] %= md;</span><span class=cls_021>//</span><span class=cls_023> </span><span class=cls_022>一般</span><span class=cls_021>N</span><span class=cls_022>范围较大的题目都需要取模</span></div> <div style=position:absolute;left:109.64px;top:488.01px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:99.82px;top:505.63px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:90.00px;top:523.24px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:74.41px;top:589.95px class=cls_017><span class=cls_017>3.3</span></div> <div style=position:absolute;left:109.40px;top:589.95px class=cls_004><span class=cls_004>二项式定理</span> </div> <div style=position:absolute;left:287.18px;top:628.06px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:306.45px;top:622.56px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:360.67px;top:638.46px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:229.49px;top:638.46px class=cls_009><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009> +</span><span class=cls_014> y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:315.49px;top:638.46px class=cls_014><span class=cls_014>k x</span><span class=cls_015><sup>n−k</sup></span><span class=cls_014>y</span></div> <div style=position:absolute;left:288.10px;top:657.50px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:4255px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background06.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>3.4</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>二项式定理的变形</span> </div> <div style=position:absolute;left:455.23px;top:44.59px class=cls_009><span class=cls_009>3</span> </div> <div style=position:absolute;left:473.05px;top:44.59px class=cls_008><span class=cls_008>基础知识</span></div> <div style=position:absolute;left:74.41px;top:83.40px class=cls_017><span class=cls_017>3.4</span> </div> <div style=position:absolute;left:109.40px;top:83.40px class=cls_004><span class=cls_004>二项式定理的变形</span> </div> <div style=position:absolute;left:163.40px;top:103.33px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:201.25px;top:102.61px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:179.43px;top:102.61px class=cls_009><span class=cls_009>(</span><span class=cls_015> n</span></div> <div style=position:absolute;left:89.21px;top:112.30px class=cls_009><span class=cls_009>1.</span> </div> <div style=position:absolute;left:104.30px;top:111.94px class=cls_009><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009> +</span><span class=cls_014> y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:206.73px;top:111.94px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>n−k</sup></span><span class=cls_014>y</span><span class=cls_015><sup>k</sup></span></div> <div style=position:absolute;left:184.91px;top:120.41px class=cls_015><span class=cls_015>n−k</span></div> <div style=position:absolute;left:161.99px;top:126.80px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:163.40px;top:141.99px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:201.25px;top:141.27px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:179.43px;top:141.27px class=cls_009><span class=cls_009>(</span><span class=cls_015> n</span></div> <div style=position:absolute;left:89.21px;top:150.95px class=cls_009><span class=cls_009>2.</span> </div> <div style=position:absolute;left:104.30px;top:150.60px class=cls_009><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009> +</span><span class=cls_014> y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:206.73px;top:150.60px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>k</sup></span><span class=cls_014>y</span><span class=cls_015><sup>n−k</sup></span></div> <div style=position:absolute;left:184.91px;top:159.06px class=cls_015><span class=cls_015>n−k</span></div> <div style=position:absolute;left:161.99px;top:165.45px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:163.40px;top:180.64px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:179.43px;top:179.92px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:189.61px class=cls_009><span class=cls_009>3.</span> </div> <div style=position:absolute;left:104.30px;top:189.25px class=cls_009><span class=cls_009>(</span><span class=cls_014>x</span><span class=cls_009> +</span><span class=cls_014> y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:195.52px;top:189.25px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>k</sup></span><span class=cls_014>y</span><span class=cls_015><sup>n−k</sup></span></div> <div style=position:absolute;left:185.16px;top:197.72px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:161.99px;top:204.11px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:229.14px;top:219.30px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:245.17px;top:218.58px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:290.19px;top:219.30px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:328.04px;top:218.58px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:306.22px;top:218.58px class=cls_009><span class=cls_009>(</span><span class=cls_015> n</span></div> <div style=position:absolute;left:89.21px;top:228.26px class=cls_009><span class=cls_009>4.</span> </div> <div style=position:absolute;left:104.30px;top:227.91px class=cls_008><span class=cls_008>有一项为</span><span class=cls_009> 1: (1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:261.26px;top:227.91px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>k</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:333.52px;top:227.91px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>k</sup></span></div> <div style=position:absolute;left:250.90px;top:236.37px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:311.70px;top:236.37px class=cls_015><span class=cls_015>n−k</span></div> <div style=position:absolute;left:227.73px;top:242.76px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:288.78px;top:242.76px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:213.09px;top:251.41px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:254.19px;top:251.41px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:319.46px;top:251.41px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:261.10px class=cls_009><span class=cls_009>5.</span> </div> <div style=position:absolute;left:104.30px;top:261.10px class=cls_008><span class=cls_008>当 </span><span class=cls_014>x </span><span class=cls_009>= 2</span><span class=cls_014>,y </span><span class=cls_009>= 1 </span><span class=cls_008>时即</span></div> <div style=position:absolute;left:229.18px;top:260.74px class=cls_009><span class=cls_009>2</span><span class=cls_016><sup>0</sup></span><span class=cls_009> +</span></div> <div style=position:absolute;left:270.28px;top:260.74px class=cls_009><span class=cls_009>2</span><span class=cls_016><sup>1</sup></span><span class=cls_009> +</span><span class=cls_014> ...</span><span class=cls_009> +</span></div> <div style=position:absolute;left:335.56px;top:260.74px class=cls_009><span class=cls_009>2</span><span class=cls_015><sup>n</sup></span><span class=cls_009> = 3</span><span class=cls_015><sup>n</sup></span></div> <div style=position:absolute;left:219.02px;top:269.20px class=cls_016><span class=cls_016>0</span> </div> <div style=position:absolute;left:260.12px;top:269.20px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:324.94px;top:269.20px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:247.92px;top:280.15px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:278.63px;top:280.15px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:309.15px;top:280.15px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:393.92px;top:280.15px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:289.84px class=cls_009><span class=cls_009>6.</span> </div> <div style=position:absolute;left:104.30px;top:289.48px class=cls_008><span class=cls_008>当 </span><span class=cls_014>x </span><span class=cls_009>= </span><span class=cls_014>y </span><span class=cls_009>= 1 </span><span class=cls_008>时 </span><span class=cls_009>(</span><span class=cls_014>x − y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:266.68px;top:289.84px class=cls_014><span class=cls_014>−</span> </div> <div style=position:absolute;left:297.39px;top:289.84px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:327.90px;top:289.48px class=cls_014><span class=cls_014>− ...</span><span class=cls_009> + (</span><span class=cls_014>−</span><span class=cls_009>1)</span><span class=cls_015><sup>n</sup></span></div> <div style=position:absolute;left:413.34px;top:289.84px class=cls_009><span class=cls_009>= 0(</span><span class=cls_014>n ≥</span></div> <div style=position:absolute;left:459.10px;top:289.84px class=cls_009><span class=cls_009>1)</span></div> <div style=position:absolute;left:253.85px;top:297.95px class=cls_016><span class=cls_016>0</span> </div> <div style=position:absolute;left:284.56px;top:297.95px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:315.08px;top:297.95px class=cls_016><span class=cls_016>2</span> </div> <div style=position:absolute;left:399.40px;top:297.95px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:247.73px;top:308.90px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:278.24px;top:308.90px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:308.76px;top:308.90px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:363.45px;top:308.90px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:318.58px class=cls_009><span class=cls_009>7.</span> </div> <div style=position:absolute;left:104.30px;top:318.23px class=cls_008><span class=cls_008>当 </span><span class=cls_014>x </span><span class=cls_009>= </span><span class=cls_014>y </span><span class=cls_009>= 1 </span><span class=cls_008>时 </span><span class=cls_009>(</span><span class=cls_014>x </span><span class=cls_009>+ </span><span class=cls_014>y</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> =</span></div> <div style=position:absolute;left:266.48px;top:318.58px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:297.00px;top:318.58px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:327.51px;top:318.58px class=cls_009><span class=cls_009>+</span><span class=cls_014> ...</span><span class=cls_009> +</span> </div> <div style=position:absolute;left:382.86px;top:318.58px class=cls_009><span class=cls_009>=</span> </div> <div style=position:absolute;left:395.28px;top:318.23px class=cls_009><span class=cls_009>2</span><span class=cls_015><sup>n</sup></span><span class=cls_009>(</span><span class=cls_014>n ≥</span></div> <div style=position:absolute;left:434.26px;top:318.58px class=cls_009><span class=cls_009>1)</span></div> <div style=position:absolute;left:253.66px;top:326.69px class=cls_016><span class=cls_016>0</span> </div> <div style=position:absolute;left:284.17px;top:326.69px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:314.69px;top:326.69px class=cls_016><span class=cls_016>2</span> </div> <div style=position:absolute;left:368.93px;top:326.69px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:104.30px;top:337.64px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:134.81px;top:337.64px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:347.32px class=cls_009><span class=cls_009>8.</span> </div> <div style=position:absolute;left:123.05px;top:347.32px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:153.57px;top:346.97px class=cls_009><span class=cls_009>+</span><span class=cls_014> ...</span><span class=cls_009> = 2</span><span class=cls_015>n−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:110.23px;top:355.43px class=cls_016><span class=cls_016>0</span> </div> <div style=position:absolute;left:140.74px;top:355.43px class=cls_016><span class=cls_016>2</span> </div> <div style=position:absolute;left:104.30px;top:366.38px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:134.81px;top:366.38px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:376.07px class=cls_009><span class=cls_009>9.</span> </div> <div style=position:absolute;left:123.05px;top:376.07px class=cls_009><span class=cls_009>+</span> </div> <div style=position:absolute;left:153.57px;top:375.71px class=cls_009><span class=cls_009>+</span><span class=cls_014> ...</span><span class=cls_009> = 2</span><span class=cls_015>n−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:110.23px;top:384.17px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:140.74px;top:384.17px class=cls_016><span class=cls_016>3</span> </div> <div style=position:absolute;left:74.41px;top:413.73px class=cls_017><span class=cls_017>3.5</span></div> <div style=position:absolute;left:109.40px;top:413.73px class=cls_004><span class=cls_004>组合数公式常见变形</span> </div> <div style=position:absolute;left:98.32px;top:442.63px class=cls_014><span class=cls_014>n, k</span><span class=cls_009> </span><span class=cls_008>都是正整数</span><span class=cls_009>，</span><span class=cls_008>公式证明见视频</span></div> <div style=position:absolute;left:110.79px;top:461.69px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:149.62px;top:461.69px class=cls_009><span class=cls_009>(</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:471.37px class=cls_009><span class=cls_009>1.</span><span class=cls_014> k</span></div> <div style=position:absolute;left:130.21px;top:471.37px class=cls_009><span class=cls_009>=</span><span class=cls_014>n</span></div> <div style=position:absolute;left:116.53px;top:479.48px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:155.36px;top:479.48px class=cls_015><span class=cls_015>k−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:110.15px;top:490.43px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:146.52px;top:490.43px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:208.19px;top:490.43px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:500.12px class=cls_009><span class=cls_009>2.</span> </div> <div style=position:absolute;left:104.30px;top:500.12px class=cls_009><span class=cls_009>1</span> </div> <div style=position:absolute;left:128.90px;top:500.12px class=cls_009><span class=cls_009>+2</span></div> <div style=position:absolute;left:165.27px;top:500.12px class=cls_009><span class=cls_009>+</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> n</span></div> <div style=position:absolute;left:227.61px;top:499.76px class=cls_009><span class=cls_009>=</span><span class=cls_014> n</span><span class=cls_009>2</span><span class=cls_015>n−</span><span class=cls_016>1</span> </div> <div style=position:absolute;left:116.08px;top:508.22px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:152.45px;top:508.22px class=cls_016><span class=cls_016>2</span> </div> <div style=position:absolute;left:213.67px;top:508.22px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:111.29px;top:519.18px class=cls_009><span class=cls_009>(</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:159.61px;top:519.18px class=cls_009><span class=cls_009>(</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:232.10px;top:519.18px class=cls_009><span class=cls_009>(</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:528.86px class=cls_009><span class=cls_009>3.</span><span class=cls_014> n</span></div> <div style=position:absolute;left:140.86px;top:528.86px class=cls_009><span class=cls_009>+</span><span class=cls_014>n</span></div> <div style=position:absolute;left:189.18px;top:528.86px class=cls_009><span class=cls_009>+</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> n</span></div> <div style=position:absolute;left:262.34px;top:528.51px class=cls_009><span class=cls_009>=</span><span class=cls_014> n</span><span class=cls_009>2</span><span class=cls_015>n−</span><span class=cls_016>1</span> </div> <div style=position:absolute;left:122.63px;top:536.97px class=cls_016><span class=cls_016>0</span> </div> <div style=position:absolute;left:170.95px;top:536.97px class=cls_016><span class=cls_016>1</span> </div> <div style=position:absolute;left:237.58px;top:536.97px class=cls_015><span class=cls_015>n−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:105.71px;top:551.79px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:132.95px;top:551.07px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:560.76px class=cls_009><span class=cls_009>4.</span> </div> <div style=position:absolute;left:121.73px;top:560.40px class=cls_014><span class=cls_014>k</span><span class=cls_016><sup>2</sup></span></div> <div style=position:absolute;left:152.37px;top:560.40px class=cls_009><span class=cls_009>=</span><span class=cls_014> n</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009> + 1)2</span><span class=cls_015>n−</span><span class=cls_016>2</span></div> <div style=position:absolute;left:138.69px;top:568.86px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:104.30px;top:575.26px class=cls_015><span class=cls_015>k</span><span class=cls_016>=1</span></div> <div style=position:absolute;left:105.71px;top:590.44px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:121.73px;top:589.73px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span><span class=cls_016>2</span></div> <div style=position:absolute;left:158.31px;top:589.73px class=cls_009><span class=cls_009>(</span><span class=cls_016>2</span><span class=cls_015>n</span><span class=cls_009>)</span></div> <div style=position:absolute;left:89.21px;top:599.41px class=cls_009><span class=cls_009>5.</span> </div> <div style=position:absolute;left:145.88px;top:599.41px class=cls_009><span class=cls_009>=</span> </div> <div style=position:absolute;left:127.47px;top:607.52px class=cls_015><span class=cls_015>k</span> </div> <div style=position:absolute;left:165.90px;top:607.52px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:104.30px;top:613.91px class=cls_015><span class=cls_015>k</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>6</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:5106px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background07.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>3.6</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>隔板法</span></div> <div style=position:absolute;left:455.23px;top:44.59px class=cls_009><span class=cls_009>3</span> </div> <div style=position:absolute;left:473.05px;top:44.59px class=cls_008><span class=cls_008>基础知识</span></div> <div style=position:absolute;left:74.41px;top:83.40px class=cls_017><span class=cls_017>3.6</span> </div> <div style=position:absolute;left:109.40px;top:83.40px class=cls_004><span class=cls_004>隔板法</span></div> <div style=position:absolute;left:98.32px;top:112.30px class=cls_014><span class=cls_014>n</span><span class=cls_008> 个相同的小球放到</span><span class=cls_014> m</span><span class=cls_009> </span><span class=cls_008>个不同的盒子里</span><span class=cls_009>, </span><span class=cls_008>盒子不能为空</span><span class=cls_009>，</span><span class=cls_008>方案数为</span> </div> <div style=position:absolute;left:273.48px;top:125.24px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n−</span><span class=cls_009>1)</span></div> <div style=position:absolute;left:282.29px;top:150.30px class=cls_014><span class=cls_014>m−</span><span class=cls_009>1</span></div> <div style=position:absolute;left:74.41px;top:172.96px class=cls_008><span class=cls_008>上面这个也等价于</span><span class=cls_014> x</span><span class=cls_016><sub>1</sub></span><span class=cls_009> +</span><span class=cls_014> x</span><span class=cls_016><sub>2</sub></span><span class=cls_009> +</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> x</span><span class=cls_015><sub>m</sub></span><span class=cls_009> =</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>的正整数解的个数</span></div> <div style=position:absolute;left:98.32px;top:191.74px class=cls_014><span class=cls_014>n</span><span class=cls_009> </span><span class=cls_008>个相同的小球放到</span><span class=cls_014> m</span><span class=cls_009> </span><span class=cls_008>个不同的盒子里</span><span class=cls_009>, </span><span class=cls_008>盒子可以为空</span><span class=cls_009>, </span><span class=cls_008>可以先给每个盒子放一</span> </div> <div style=position:absolute;left:74.41px;top:210.52px class=cls_008><span class=cls_008>个球</span><span class=cls_009>, </span><span class=cls_008>问题等价于将</span><span class=cls_009> n+m </span><span class=cls_008>个相同的小球放入</span><span class=cls_009> m </span><span class=cls_008>个不同的盒子里</span><span class=cls_009>, </span><span class=cls_008>不为空</span></div> <div style=position:absolute;left:262.78px;top:231.22px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>m</span><span class=cls_009> +</span><span class=cls_014> n −</span><span class=cls_009> 1)</span></div> <div style=position:absolute;left:282.29px;top:256.28px class=cls_014><span class=cls_014>m−</span><span class=cls_009>1</span></div> <div style=position:absolute;left:74.41px;top:285.33px class=cls_017><span class=cls_017>3.7</span></div> <div style=position:absolute;left:109.40px;top:285.33px class=cls_004><span class=cls_004>错位排列</span> </div> <div style=position:absolute;left:98.32px;top:314.23px class=cls_008><span class=cls_008>每个数都不在自己位置的排列叫做错位排列</span><span class=cls_009>，</span><span class=cls_008>假设排列为</span><span class=cls_014> f</span><span class=cls_016><sub>1</sub></span><span class=cls_014>,f</span><span class=cls_016><sub>2</sub></span><span class=cls_014>...f</span><span class=cls_015><sub>n</sub></span><span class=cls_009>, </span><span class=cls_008>错位排列满</span> </div> <div style=position:absolute;left:74.41px;top:333.01px class=cls_008><span class=cls_008>足对于所有的</span><span class=cls_009> 1</span><span class=cls_014> ≤ i ≤ n</span><span class=cls_009>,</span><span class=cls_014> f</span><span class=cls_015><sub>i</sub></span><span class=cls_009>! =</span><span class=cls_014> i</span></div> <div style=position:absolute;left:98.32px;top:351.79px class=cls_008><span class=cls_008>错排的递推公式</span> </div> <div style=position:absolute;left:254.01px;top:370.57px class=cls_014><span class=cls_014>f</span><span class=cls_009> [1] = 0</span><span class=cls_014>, f</span><span class=cls_009> [2] = 1</span> </div> <div style=position:absolute;left:191.45px;top:394.63px class=cls_014><span class=cls_014>f</span><span class=cls_009> [</span><span class=cls_014>i</span><span class=cls_009>] = (</span><span class=cls_014>i −</span><span class=cls_009> 1)</span><span class=cls_014> ∗</span><span class=cls_009> (</span><span class=cls_014>f</span><span class=cls_009> [</span><span class=cls_014>i −</span><span class=cls_009> 2] +</span><span class=cls_014> f</span><span class=cls_009> [</span><span class=cls_014>i −</span><span class=cls_009> 1])(</span><span class=cls_014>i ></span><span class=cls_009> 3)</span></div> <div style=position:absolute;left:98.32px;top:418.69px class=cls_008><span class=cls_008>证明</span><span class=cls_009>：</span><span class=cls_008>假设将</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>放到</span><span class=cls_009> 1 </span><span class=cls_008>到</span><span class=cls_014> i −</span><span class=cls_009> 1 </span><span class=cls_008>的某个位置</span><span class=cls_014> j</span><span class=cls_009>, </span><span class=cls_008>假设</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>这个数放到</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>位置</span><span class=cls_009>, </span><span class=cls_008>那么方</span></div> <div style=position:absolute;left:74.41px;top:437.47px class=cls_008><span class=cls_008>案数就是剩下的</span><span class=cls_014> i −</span><span class=cls_009> 2 </span><span class=cls_008>个数进行错排</span><span class=cls_009>, </span><span class=cls_008>假如</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>这个数不放在</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>的位置上</span><span class=cls_009>, </span><span class=cls_008>那么就是</span><span class=cls_014> i −</span><span class=cls_009> 1</span></div> <div style=position:absolute;left:74.41px;top:456.25px class=cls_008><span class=cls_008>个数进行错排</span><span class=cls_009>, </span><span class=cls_008>注意这里思维的巧妙转换</span><span class=cls_009>，</span><span class=cls_014>i</span><span class=cls_009> </span><span class=cls_008>位置相当于</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>的一个新的限制位置了</span></div> <div style=position:absolute;left:74.41px;top:493.50px class=cls_017><span class=cls_017>3.8</span></div> <div style=position:absolute;left:109.40px;top:493.50px class=cls_004><span class=cls_004>圆排列</span></div> <div style=position:absolute;left:98.32px;top:522.40px class=cls_008><span class=cls_008>对于每种排列</span><span class=cls_009>, </span><span class=cls_008>循环移动一圈</span><span class=cls_009>, </span><span class=cls_008>都算同一种排列</span><span class=cls_009>, </span><span class=cls_008>相当于将总的排列分成了若干组</span><span class=cls_009>,</span></div> <div style=position:absolute;left:74.41px;top:540.46px class=cls_008><span class=cls_008>每组的本质是相同的</span><span class=cls_009>, </span><span class=cls_008>而且每组里面有</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个排列</span><span class=cls_009>, </span><span class=cls_008>那么本质不同的圆排列就有</span><span class=cls_025>n</span><span class=cls_026>!</span></div> <div style=position:absolute;left:480.37px;top:541.18px class=cls_015><span class=cls_015>n</span><span class=cls_009> </span><span class=cls_008>种</span> </div> <div style=position:absolute;left:74.41px;top:578.44px class=cls_017><span class=cls_017>3.9</span></div> <div style=position:absolute;left:109.40px;top:578.44px class=cls_004><span class=cls_004>多重集合的排列</span> </div> <div style=position:absolute;left:98.32px;top:607.34px class=cls_008><span class=cls_008>设</span><span class=cls_014> S</span><span class=cls_009> </span><span class=cls_008>是有</span><span class=cls_014> k</span><span class=cls_009> </span><span class=cls_008>种不同类型对象的多重集合</span><span class=cls_009>, </span><span class=cls_008>每一个元素都有无线重复数</span><span class=cls_009>, </span><span class=cls_008>那么</span><span class=cls_009>,</span><span class=cls_014>S</span><span class=cls_009> </span><span class=cls_008>的</span> </div> <div style=position:absolute;left:74.41px;top:625.76px class=cls_014><span class=cls_014>r</span><span class=cls_009> </span><span class=cls_008>排列的数量是</span><span class=cls_014> k</span><span class=cls_015><sup>r</sup></span></div> <div style=position:absolute;left:98.32px;top:644.90px class=cls_008><span class=cls_008>设</span><span class=cls_014> S</span><span class=cls_009> </span><span class=cls_008>是多重集合</span><span class=cls_009>, </span><span class=cls_008>它有</span><span class=cls_014> k</span><span class=cls_009> </span><span class=cls_008>种不同类型的对象</span><span class=cls_009>, </span><span class=cls_008>且每一种类型的有限重复数分别为</span></div> <div style=position:absolute;left:74.41px;top:663.68px class=cls_014><span class=cls_014>n</span><span class=cls_016><sub>1</sub></span><span class=cls_014>,n</span><span class=cls_016><sub>2</sub></span><span class=cls_014>,...,n</span><span class=cls_015><sub>k</sub></span><span class=cls_009> </span><span class=cls_008>设</span><span class=cls_009> S </span><span class=cls_008>的大小为</span><span class=cls_014> n</span><span class=cls_009> =</span><span class=cls_014> n</span><span class=cls_016><sub>1</sub></span><span class=cls_009> +</span><span class=cls_014> n</span><span class=cls_016><sub>2</sub></span><span class=cls_009> +</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> n</span><span class=cls_015><sub>k</sub></span><span class=cls_009>. </span><span class=cls_008>则</span><span class=cls_014> S</span><span class=cls_009> </span><span class=cls_008>的排列数目等于</span></div> <div style=position:absolute;left:292.52px;top:693.15px class=cls_014><span class=cls_014>n</span><span class=cls_009>!</span></div> <div style=position:absolute;left:270.11px;top:709.44px class=cls_014><span class=cls_014>n</span><span class=cls_016><sub>1</sub></span><span class=cls_009>!</span><span class=cls_014>n</span><span class=cls_016><sub>2</sub></span><span class=cls_009>!</span><span class=cls_014>...n</span><span class=cls_015><sub>k</sub></span><span class=cls_009>!</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:5957px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background08.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>3.10</span></div> <div style=position:absolute;left:107.19px;top:44.59px class=cls_008><span class=cls_008>多重集合的组合</span> </div> <div style=position:absolute;left:455.23px;top:44.59px class=cls_009><span class=cls_009>3</span> </div> <div style=position:absolute;left:473.05px;top:44.59px class=cls_008><span class=cls_008>基础知识</span></div> <div style=position:absolute;left:98.32px;top:85.79px class=cls_008><span class=cls_008>证明</span><span class=cls_009>: </span><span class=cls_008>相当于先选出</span><span class=cls_014> n</span><span class=cls_016><sub>1</sub></span><span class=cls_009> </span><span class=cls_008>个位置</span><span class=cls_009>, </span><span class=cls_008>再选出</span><span class=cls_014> n</span><span class=cls_016><sub>2</sub></span><span class=cls_009> </span><span class=cls_008>个位置</span><span class=cls_009>...</span></div> <div style=position:absolute;left:293.13px;top:106.49px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:144.43px;top:106.49px class=cls_009><span class=cls_009>( </span><span class=cls_014>n </span><span class=cls_009><sup>)(</sup></span><span class=cls_014>n − n</span><span class=cls_016><sub>1</sub></span><span class=cls_009>)(</span><span class=cls_014>n − n</span><span class=cls_016><sub>1</sub></span><span class=cls_014> − n</span><span class=cls_016><sub>2</sub></span></div> <div style=position:absolute;left:311.68px;top:106.49px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n − n</span><span class=cls_016><sub>1</sub></span><span class=cls_014> − n</span><span class=cls_016><sub>2</sub></span><span class=cls_014> − ... − n</span><span class=cls_015>k−</span><span class=cls_016>1</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:153.24px;top:131.55px class=cls_014><span class=cls_014>n</span><span class=cls_016><sub>1</sub></span></div> <div style=position:absolute;left:193.36px;top:131.55px class=cls_014><span class=cls_014>n</span><span class=cls_016><sub>2</sub></span></div> <div style=position:absolute;left:257.44px;top:131.55px class=cls_014><span class=cls_014>n</span><span class=cls_016><sub>3</sub></span></div> <div style=position:absolute;left:375.21px;top:131.55px class=cls_014><span class=cls_014>n</span><span class=cls_015><sub>k</sub></span></div> <div style=position:absolute;left:98.32px;top:151.49px class=cls_008><span class=cls_008>化简这个式子就可以证明了</span></div> <div style=position:absolute;left:74.41px;top:189.16px class=cls_017><span class=cls_017>3.10</span></div> <div style=position:absolute;left:117.48px;top:189.16px class=cls_004><span class=cls_004>多重集合的组合</span> </div> <div style=position:absolute;left:98.32px;top:218.06px class=cls_008><span class=cls_008>设</span><span class=cls_014> S</span><span class=cls_009> </span><span class=cls_008>是有</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>种类型的对象的多重集合</span><span class=cls_009>, </span><span class=cls_008>每种元素均有无限的重复数</span><span class=cls_009>, </span><span class=cls_008>那么</span><span class=cls_014> S</span><span class=cls_009> </span><span class=cls_008>的</span><span class=cls_014> k</span></div> <div style=position:absolute;left:74.41px;top:236.84px class=cls_008><span class=cls_008>组合的个数等于</span> </div> <div style=position:absolute;left:223.80px;top:257.54px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009> +</span><span class=cls_014> k −</span><span class=cls_009> 1)</span></div> <div style=position:absolute;left:305.51px;top:257.54px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009> +</span><span class=cls_014> k −</span><span class=cls_009> 1)</span></div> <div style=position:absolute;left:293.08px;top:274.40px class=cls_009><span class=cls_009>=</span> </div> <div style=position:absolute;left:253.54px;top:282.60px class=cls_014><span class=cls_014>k</span> </div> <div style=position:absolute;left:324.77px;top:282.60px class=cls_014><span class=cls_014>n−</span><span class=cls_009>1</span></div> <div style=position:absolute;left:98.32px;top:302.64px class=cls_008><span class=cls_008>问题等价于选</span><span class=cls_014> k</span><span class=cls_009> </span><span class=cls_008>次球</span><span class=cls_009>, </span><span class=cls_008>每次都可以选</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>种球的方案数</span><span class=cls_009>, </span><span class=cls_008>选球不分先后</span> </div> <div style=position:absolute;left:98.32px;top:321.42px class=cls_008><span class=cls_008>等价于</span><span class=cls_014> k</span><span class=cls_009> </span><span class=cls_008>个相同的球放到</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个不同的盒子里</span><span class=cls_009>, </span><span class=cls_008>盒子可以为空</span></div> <div style=position:absolute;left:74.41px;top:359.08px class=cls_017><span class=cls_017>3.11</span></div> <div style=position:absolute;left:117.48px;top:359.08px class=cls_004><span class=cls_004>鸽巢原理</span> </div> <div style=position:absolute;left:74.41px;top:387.98px class=cls_012><span class=cls_012>3.11.1</span> </div> <div style=position:absolute;left:120.77px;top:387.98px class=cls_008><span class=cls_008>普通鸽巢原理</span> </div> <div style=position:absolute;left:98.32px;top:414.49px class=cls_008><span class=cls_008>如果要把</span><span class=cls_014> n</span><span class=cls_009> + 1 </span><span class=cls_008>个物体放进</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个盒子</span><span class=cls_009>，</span><span class=cls_008>那么至少有一个盒子包含两个或更多的物</span></div> <div style=position:absolute;left:74.41px;top:433.27px class=cls_008><span class=cls_008>体</span> </div> <div style=position:absolute;left:98.32px;top:452.05px class=cls_008><span class=cls_008>比如</span><span class=cls_009>，</span><span class=cls_008>在</span><span class=cls_009> 13 </span><span class=cls_008>个人中一定存在两个人生日是同一月份</span><span class=cls_009>，</span><span class=cls_014>n</span><span class=cls_009> </span><span class=cls_008>对新婚夫妇</span><span class=cls_009>，</span><span class=cls_008>选择</span><span class=cls_014> n</span><span class=cls_009> + 1</span></div> <div style=position:absolute;left:74.41px;top:470.83px class=cls_008><span class=cls_008>人就一定会包含一对新婚夫妇。</span></div> <div style=position:absolute;left:74.41px;top:506.36px class=cls_012><span class=cls_012>3.11.2</span> </div> <div style=position:absolute;left:120.77px;top:506.36px class=cls_008><span class=cls_008>加强版鸽巢原理</span> </div> <div style=position:absolute;left:98.32px;top:532.86px class=cls_008><span class=cls_008>设</span><span class=cls_014> q</span><span class=cls_016><sub>1</sub></span><span class=cls_014>,q</span><span class=cls_016><sub>2</sub></span><span class=cls_014>,...,q</span><span class=cls_015><sub>n</sub></span><span class=cls_009> </span><span class=cls_008>是正整数</span><span class=cls_009>，</span><span class=cls_008>如果将</span><span class=cls_014> q</span><span class=cls_016><sub>1</sub></span><span class=cls_009> +</span><span class=cls_014> q</span><span class=cls_016><sub>2</sub></span><span class=cls_009> +</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> q</span><span class=cls_015><sub>n</sub></span><span class=cls_014> − n</span><span class=cls_009> + 1 </span><span class=cls_008>个物体放入</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个盒子</span></div> <div style=position:absolute;left:74.41px;top:551.64px class=cls_008><span class=cls_008>内</span><span class=cls_009>，</span><span class=cls_008>那么或者第一个盒子至少含有</span><span class=cls_014> q</span><span class=cls_016><sub>1</sub></span><span class=cls_009> </span><span class=cls_008>个物体</span><span class=cls_009>，</span><span class=cls_008>或者第二个盒子至少含有</span><span class=cls_014> q</span><span class=cls_016><sub>2</sub></span><span class=cls_009> </span><span class=cls_008>个物体</span><span class=cls_009>,...,</span></div> <div style=position:absolute;left:74.41px;top:570.42px class=cls_008><span class=cls_008>或者第</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个盒子至少含有</span><span class=cls_014> q</span><span class=cls_015><sub>n</sub></span><span class=cls_009> </span><span class=cls_008>个物体</span></div> <div style=position:absolute;left:98.32px;top:589.20px class=cls_008><span class=cls_008>证明</span><span class=cls_009>：</span><span class=cls_008>采用反证法</span><span class=cls_009>，</span><span class=cls_008>假设第</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>个盒子含有少于</span><span class=cls_014> q</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>个物体</span><span class=cls_009>，</span><span class=cls_008>那么所有盒子中的物体</span></div> <div style=position:absolute;left:74.41px;top:607.98px class=cls_008><span class=cls_008>总数不超过</span> </div> <div style=position:absolute;left:150.93px;top:645.54px class=cls_009><span class=cls_009>(</span><span class=cls_014>q</span><span class=cls_016><sub>1</sub></span><span class=cls_014> −</span><span class=cls_009> 1) + (</span><span class=cls_014>q</span><span class=cls_016><sub>2</sub></span><span class=cls_014> −</span><span class=cls_009> 1) +</span><span class=cls_014> ...</span><span class=cls_009> + (</span><span class=cls_014>q</span><span class=cls_015><sub>n</sub></span><span class=cls_014> −</span><span class=cls_009> 1) =</span><span class=cls_014> q</span><span class=cls_016><sub>1</sub></span><span class=cls_009> +</span><span class=cls_014> q</span><span class=cls_016><sub>2</sub></span><span class=cls_009> +</span><span class=cls_014> ...</span><span class=cls_009> +</span><span class=cls_014> q</span><span class=cls_015><sub>n</sub></span><span class=cls_014> − n</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>8</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:6808px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background09.jpg width=595 height=841></div> <div style=position:absolute;left:455.23px;top:44.59px class=cls_009><span class=cls_009>4</span> </div> <div style=position:absolute;left:473.05px;top:44.59px class=cls_008><span class=cls_008>康托展开</span></div> <div style=position:absolute;left:74.41px;top:81.80px class=cls_006><span class=cls_006>4</span> </div> <div style=position:absolute;left:101.32px;top:81.80px class=cls_007><span class=cls_007>康托展开</span></div> <div style=position:absolute;left:74.41px;top:119.83px class=cls_017><span class=cls_017>4.1</span></div> <div style=position:absolute;left:109.40px;top:119.83px class=cls_004><span class=cls_004>计算排列的排名</span> </div> <div style=position:absolute;left:98.32px;top:148.73px class=cls_008><span class=cls_008>给你一个排列</span><span class=cls_009>, </span><span class=cls_008>计算这个排列之前的排列总数公式为</span></div> <div style=position:absolute;left:98.32px;top:167.51px class=cls_014><span class=cls_014>X</span><span class=cls_009> = </span><span class=cls_014>a</span><span class=cls_016><sub>1</sub></span><span class=cls_009>(</span><span class=cls_014>n − </span><span class=cls_009>1)! + </span><span class=cls_014>a</span><span class=cls_016><sub>2</sub></span><span class=cls_009>(</span><span class=cls_014>n − </span><span class=cls_009>2)! + </span><span class=cls_014>... </span><span class=cls_009>+ </span><span class=cls_014>a</span><span class=cls_015><sub>n</sub></span><span class=cls_009>0!</span></div> <div style=position:absolute;left:98.32px;top:186.29px class=cls_014><span class=cls_014>a</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>是从左往右数的第</span><span class=cls_009> i </span><span class=cls_008>个数右边小于它的数的个数</span> </div> <div style=position:absolute;left:98.32px;top:205.07px class=cls_008><span class=cls_008>比如</span><span class=cls_009> [2</span><span class=cls_014>,</span><span class=cls_009> 3</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 1], </span><span class=cls_008>那么</span><span class=cls_014> a</span><span class=cls_016><sub>1</sub></span><span class=cls_009> = 1</span><span class=cls_014>, a</span><span class=cls_016><sub>2</sub></span><span class=cls_009> = 1</span><span class=cls_014>, a</span><span class=cls_016><sub>3</sub></span><span class=cls_009> = 1</span><span class=cls_014>, a</span><span class=cls_016><sub>4</sub></span><span class=cls_009> = 0</span></div> <div style=position:absolute;left:98.32px;top:223.85px class=cls_008><span class=cls_008>因此</span><span class=cls_014> X</span><span class=cls_009> = 1</span><span class=cls_014> ∗</span><span class=cls_009> 3! + 1</span><span class=cls_014> ∗</span><span class=cls_009> 2! + 1</span><span class=cls_014> ∗</span><span class=cls_009> 1! + 0 = 9，</span><span class=cls_008>表示这个排列前面一共有</span><span class=cls_009> 9 </span><span class=cls_008>个排列</span><span class=cls_009>，</span><span class=cls_008>这</span> </div> <div style=position:absolute;left:74.41px;top:242.63px class=cls_008><span class=cls_008>个排列是第</span><span class=cls_009> 10 </span><span class=cls_008>个排列</span></div> <div style=position:absolute;left:74.41px;top:280.29px class=cls_017><span class=cls_017>4.2</span></div> <div style=position:absolute;left:109.40px;top:280.29px class=cls_004><span class=cls_004>计算特定排名的排列</span> </div> <div style=position:absolute;left:98.32px;top:309.19px class=cls_008><span class=cls_008>这个方法也经常叫康托展开的逆展开</span><span class=cls_009>，</span><span class=cls_008>也就是告诉你一个排列的排名</span><span class=cls_009>, </span><span class=cls_008>让你复原这</span> </div> <div style=position:absolute;left:74.41px;top:327.97px class=cls_008><span class=cls_008>个排列</span></div> <div style=position:absolute;left:98.32px;top:346.75px class=cls_008><span class=cls_008>比如让你求五个数的</span><span class=cls_009> 107 </span><span class=cls_008>个排列是谁</span><span class=cls_009>, </span><span class=cls_008>假设第一个是</span><span class=cls_009> 12345</span></div> <div style=position:absolute;left:98.32px;top:365.53px class=cls_008><span class=cls_008>假设排列的编号从</span><span class=cls_009> 0 </span><span class=cls_008>开始</span><span class=cls_009>, </span><span class=cls_008>那么我们就是求编号为</span><span class=cls_009> 106 </span><span class=cls_008>的排列</span></div> <div style=position:absolute;left:98.32px;top:384.31px class=cls_008><span class=cls_008>利用康托展开的公式</span><span class=cls_009>，</span><span class=cls_008>从高到低确定每一位</span> </div> <div style=position:absolute;left:99.51px;top:402.37px class=cls_027><span class=cls_027>106</span></div> <div style=position:absolute;left:116.73px;top:403.09px class=cls_009><span class=cls_009>= 4 , </span><span class=cls_008>余 </span><span class=cls_009>10, </span><span class=cls_008>说明第一位右边有 </span><span class=cls_009>4 </span><span class=cls_008>个比它小</span><span class=cls_009>, </span><span class=cls_008>所以最高位为 </span><span class=cls_009>5</span></div> <div style=position:absolute;left:102.57px;top:411.20px class=cls_016><span class=cls_016>4!</span></div> <div style=position:absolute;left:99.51px;top:421.15px class=cls_027><span class=cls_027>10</span> </div> <div style=position:absolute;left:112.50px;top:421.87px class=cls_009><span class=cls_009>= 1, </span><span class=cls_008>余</span><span class=cls_009> 4, </span><span class=cls_008>说明第二位右边有</span><span class=cls_009> 1 </span><span class=cls_008>个比它小</span><span class=cls_009>, </span><span class=cls_008>所以当前位为</span><span class=cls_009> 2</span></div> <div style=position:absolute;left:100.46px;top:429.98px class=cls_016><span class=cls_016>3!</span></div> <div style=position:absolute;left:100.69px;top:439.93px class=cls_027><span class=cls_027>4</span> </div> <div style=position:absolute;left:110.62px;top:440.65px class=cls_009><span class=cls_009>= 2, </span><span class=cls_008>余</span><span class=cls_009> 0, </span><span class=cls_008>说明第三位右边有</span><span class=cls_009> 2 </span><span class=cls_008>个比它小</span><span class=cls_009>, </span><span class=cls_008>所以当前位为</span><span class=cls_009> 4</span></div> <div style=position:absolute;left:99.51px;top:448.76px class=cls_016><span class=cls_016>2!</span> </div> <div style=position:absolute;left:100.69px;top:458.71px class=cls_027><span class=cls_027>0</span> </div> <div style=position:absolute;left:110.62px;top:459.43px class=cls_009><span class=cls_009>= 0, </span><span class=cls_008>余</span><span class=cls_009> 0，</span><span class=cls_008>说明第四位右边没有数比它小</span><span class=cls_009>，</span><span class=cls_008>所以当前位为</span><span class=cls_009> 1</span></div> <div style=position:absolute;left:99.51px;top:467.54px class=cls_016><span class=cls_016>1!</span> </div> <div style=position:absolute;left:98.32px;top:478.21px class=cls_008><span class=cls_008>最后一位为</span><span class=cls_009> 3</span></div> <div style=position:absolute;left:98.32px;top:496.99px class=cls_008><span class=cls_008>可以得到最终排列为</span><span class=cls_009> [5</span><span class=cls_014>,</span><span class=cls_009> 2</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 1</span><span class=cls_014>,</span><span class=cls_009> 3]</span></div> <div style=position:absolute;left:98.32px;top:515.77px class=cls_008><span class=cls_008>思想类似于进制转换</span> </div> <div style=position:absolute;left:74.41px;top:553.44px class=cls_017><span class=cls_017>4.3</span></div> <div style=position:absolute;left:109.40px;top:553.44px class=cls_004><span class=cls_004>下一个排列</span> </div> <div style=position:absolute;left:98.32px;top:582.34px class=cls_008><span class=cls_008>这里顺便提一下如何比较简单的寻找某个排列的下一个排列</span><span class=cls_009>，</span><span class=cls_008>对于一个排列</span><span class=cls_014> p</span><span class=cls_016><sub>1</sub></span><span class=cls_014>, p</span><span class=cls_016><sub>2</sub></span><span class=cls_014>, ..., p</span><span class=cls_015><sub>n</sub></span><span class=cls_009>,</span></div> <div style=position:absolute;left:74.41px;top:601.12px class=cls_008><span class=cls_008>我们从后往前扫描</span><span class=cls_009>，</span><span class=cls_008>找到第一个</span><span class=cls_014> p</span><span class=cls_015><sub>i</sub></span><span class=cls_014> &lt; p</span><span class=cls_015>i</span><span class=cls_016>+1</span><span class=cls_009> </span><span class=cls_008>的地方</span><span class=cls_009>，</span><span class=cls_008>然后从后往前找到第一个</span><span class=cls_014> p</span><span class=cls_015><sub>j</sub></span><span class=cls_014> &lt; p</span><span class=cls_015><sub>i</sub></span></div> <div style=position:absolute;left:74.41px;top:619.90px class=cls_008><span class=cls_008>将 </span><span class=cls_014>p</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>与 </span><span class=cls_014>p</span><span class=cls_015><sub>j</sub></span><span class=cls_009> </span><span class=cls_008>交换</span><span class=cls_009>，</span><span class=cls_008>然后将 </span><span class=cls_014>i </span><span class=cls_008>位置以后的所有元素颠倒过来</span> </div> <div style=position:absolute;left:98.32px;top:638.68px class=cls_008><span class=cls_008>比如</span><span class=cls_009> [1</span><span class=cls_014>,</span><span class=cls_009> 2</span><span class=cls_014>,</span><span class=cls_009> 5</span><span class=cls_014>,</span><span class=cls_009> 7</span><span class=cls_014>,</span><span class=cls_009> 6</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 3] , </span><span class=cls_008>找到第一对</span><span class=cls_014> p</span><span class=cls_015><sub>i</sub></span><span class=cls_014> &lt; p</span><span class=cls_015>i</span><span class=cls_016>+1</span><span class=cls_009> </span><span class=cls_008>是</span><span class=cls_009> (5</span><span class=cls_014>,</span><span class=cls_009> 7), </span><span class=cls_008>从后往前找到一个数</span><span class=cls_009> 6 </span><span class=cls_008>比</span><span class=cls_009> 5</span></div> <div style=position:absolute;left:74.41px;top:657.46px class=cls_008><span class=cls_008>要大</span><span class=cls_009>，</span><span class=cls_008>交换后得到</span><span class=cls_009> [1</span><span class=cls_014>,</span><span class=cls_009> 2</span><span class=cls_014>,</span><span class=cls_009> 6</span><span class=cls_014>,</span><span class=cls_009> 7</span><span class=cls_014>,</span><span class=cls_009> 5</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 3]，</span><span class=cls_008>然后将</span><span class=cls_009> [7</span><span class=cls_014>,</span><span class=cls_009> 5</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 3] </span><span class=cls_008>反转可得</span><span class=cls_009> [1</span><span class=cls_014>,</span><span class=cls_009> 2</span><span class=cls_014>,</span><span class=cls_009> 6</span><span class=cls_014>,</span><span class=cls_009> 7</span><span class=cls_014>,</span><span class=cls_009> 3</span><span class=cls_014>,</span><span class=cls_009> 4</span><span class=cls_014>,</span><span class=cls_009> 5]</span></div> <div style=position:absolute;left:294.71px;top:735.14px class=cls_009><span class=cls_009>9</span> </div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:7659px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background10.jpg width=595 height=841></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>特殊的数列</span> </div> <div style=position:absolute;left:74.41px;top:81.59px class=cls_006><span class=cls_006>5</span> </div> <div style=position:absolute;left:101.32px;top:81.59px class=cls_007><span class=cls_007>特殊的数列</span> </div> <div style=position:absolute;left:74.41px;top:119.62px class=cls_017><span class=cls_017>5.1</span></div> <div style=position:absolute;left:109.40px;top:119.62px class=cls_004><span class=cls_004>第一类斯特林数</span> </div> <div style=position:absolute;left:98.32px;top:148.52px class=cls_008><span class=cls_008>将 </span><span class=cls_014>n </span><span class=cls_008>个不同物体排成 </span><span class=cls_014>k</span><span class=cls_009> </span><span class=cls_008>个非空环的方案数</span></div> <div style=position:absolute;left:98.32px;top:167.30px class=cls_014><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>n</span><span class=cls_009>][</span><span class=cls_014>k</span><span class=cls_009>] = (</span><span class=cls_014>n −</span><span class=cls_009> 1)</span><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>n −</span><span class=cls_009> 1][</span><span class=cls_014>k</span><span class=cls_009>] +</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>n −</span><span class=cls_009> 1][</span><span class=cls_014>k −</span><span class=cls_009> 1]</span></div> <div style=position:absolute;left:98.32px;top:186.08px class=cls_008><span class=cls_008>要么自己成一个环</span><span class=cls_009>, </span><span class=cls_008>要么凑到之前的某个环里</span><span class=cls_009>, </span><span class=cls_008>凑到之前的环里一共有</span><span class=cls_014> n −</span></div> <div style=position:absolute;left:486.95px;top:186.08px class=cls_009><span class=cls_009>1</span> </div> <div style=position:absolute;left:496.91px;top:186.08px class=cls_008><span class=cls_008>种空</span></div> <div style=position:absolute;left:74.41px;top:204.86px class=cls_008><span class=cls_008>位可以插入</span> </div> <div style=position:absolute;left:90.00px;top:224.43px class=cls_018><span class=cls_018>第一类斯特林数</span> </div> <div style=position:absolute;left:90.00px;top:251.39px class=cls_019><span class=cls_019>void</span><span class=cls_020> init(</span><span class=cls_019>int</span><span class=cls_020> n) {</span></div> <div style=position:absolute;left:109.64px;top:269.00px class=cls_020><span class=cls_020>dp[0][0]=dp[1][1]=1;</span></div> <div style=position:absolute;left:109.64px;top:286.62px class=cls_019><span class=cls_019>for</span><span class=cls_020>(</span><span class=cls_019>int</span><span class=cls_020> i=2;i&lt;=n;i++){</span> </div> <div style=position:absolute;left:129.27px;top:304.23px class=cls_019><span class=cls_019>for</span><span class=cls_020>(</span><span class=cls_019>int</span><span class=cls_020> j=1;j&lt;=i;j++){</span> </div> <div style=position:absolute;left:148.91px;top:321.84px class=cls_020><span class=cls_020>dp[i][j]=dp[i-1][j-1]+(i-1)*dp[i-1][j];</span></div> <div style=position:absolute;left:148.91px;top:339.46px class=cls_020><span class=cls_020>dp[i][j]%=MOD;</span></div> <div style=position:absolute;left:129.27px;top:357.07px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:109.64px;top:374.68px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:90.00px;top:392.30px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:74.41px;top:459.01px class=cls_017><span class=cls_017>5.2</span></div> <div style=position:absolute;left:109.40px;top:459.01px class=cls_004><span class=cls_004>第二类斯特林数</span> </div> <div style=position:absolute;left:98.32px;top:487.91px class=cls_008><span class=cls_008>将 </span><span class=cls_014>n </span><span class=cls_008>个不同物体分成 </span><span class=cls_014>k</span><span class=cls_009> </span><span class=cls_008>个非空集合的方案数</span></div> <div style=position:absolute;left:98.32px;top:506.69px class=cls_008><span class=cls_008>相当于将</span><span class=cls_014> n</span><span class=cls_009> </span><span class=cls_008>个不同的小球</span><span class=cls_009>, </span><span class=cls_008>放到</span><span class=cls_014> k</span><span class=cls_009> </span><span class=cls_008>个相同的盒子里</span><span class=cls_009>, </span><span class=cls_008>不能为空</span> </div> <div style=position:absolute;left:98.32px;top:525.46px class=cls_014><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>n</span><span class=cls_009>][</span><span class=cls_014>k</span><span class=cls_009>] =</span><span class=cls_014> k ∗ dp</span><span class=cls_009>[</span><span class=cls_014>n −</span><span class=cls_009> 1][</span><span class=cls_014>k</span><span class=cls_009>] +</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>n −</span><span class=cls_009> 1][</span><span class=cls_014>k −</span><span class=cls_009> 1]</span></div> <div style=position:absolute;left:98.32px;top:544.24px class=cls_008><span class=cls_008>即</span><span class=cls_009>, </span><span class=cls_008>当前这个球要么放到之前的盒子里</span><span class=cls_009>, </span><span class=cls_008>要么新开一个盒子</span></div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>10</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:8510px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background11.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>5.3</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>卡特兰数</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>特殊的数列</span> </div> <div style=position:absolute;left:90.00px;top:87.41px class=cls_018><span class=cls_018>第一类斯特林数</span> </div> <div style=position:absolute;left:90.00px;top:114.37px class=cls_019><span class=cls_019>void</span><span class=cls_020> init(</span><span class=cls_019>int</span><span class=cls_020> n){</span></div> <div style=position:absolute;left:109.64px;top:131.98px class=cls_019><span class=cls_019>for</span><span class=cls_020>(</span><span class=cls_019>int</span><span class=cls_020> i=0;i&lt;=n;i++){</span> </div> <div style=position:absolute;left:129.27px;top:149.60px class=cls_020><span class=cls_020>dp[i][i]=dp[i][1]=1;</span></div> <div style=position:absolute;left:129.27px;top:167.21px class=cls_019><span class=cls_019>for</span><span class=cls_020>(</span><span class=cls_019>int</span><span class=cls_020> j=2;j&lt;i;j++){</span> </div> <div style=position:absolute;left:148.91px;top:184.82px class=cls_020><span class=cls_020>dp[i][j]=(dp[i-1][j-1]+1LL*j*dp[i-1][j]%MOD)%MOD;</span></div> <div style=position:absolute;left:129.27px;top:202.44px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:109.64px;top:220.05px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:90.00px;top:237.67px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:74.41px;top:304.37px class=cls_017><span class=cls_017>5.3</span></div> <div style=position:absolute;left:109.40px;top:304.37px class=cls_004><span class=cls_004>卡特兰数</span> </div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>11</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:9361px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background12.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>5.3</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>卡特兰数</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>5</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>特殊的数列</span> </div> <div style=position:absolute;left:98.32px;top:85.79px class=cls_008><span class=cls_008>假如有一个</span><span class=cls_014> n ∗ n</span><span class=cls_009> </span><span class=cls_008>的网格</span><span class=cls_009>，</span><span class=cls_008>从左下角的</span><span class=cls_009> A </span><span class=cls_008>点走到右上角的</span><span class=cls_009> B </span><span class=cls_008>点</span><span class=cls_009>, </span><span class=cls_008>始终不超过对角</span></div> <div style=position:absolute;left:74.41px;top:104.57px class=cls_008><span class=cls_008>线的走法有多少种</span> </div> <div style=position:absolute;left:98.32px;top:123.35px class=cls_008><span class=cls_008>观察上图可得</span><span class=cls_009>, </span><span class=cls_008>任何一条非法路径一定存在一个中间点在对角线上方</span><span class=cls_009>, </span><span class=cls_008>也就是会碰</span></div> <div style=position:absolute;left:74.41px;top:142.13px class=cls_008><span class=cls_008>到红色的那条线</span><span class=cls_009>, </span><span class=cls_008>假设第一个碰到的是</span><span class=cls_009> P</span></div> <div style=position:absolute;left:98.32px;top:160.91px class=cls_008><span class=cls_008>我们从</span><span class=cls_009> P </span><span class=cls_008>点开始</span><span class=cls_009>, </span><span class=cls_008>将之后的那部分蓝色的线</span><span class=cls_009>, </span><span class=cls_008>按照对角线上方的斜线做对称</span><span class=cls_009>, </span><span class=cls_008>最终</span></div> <div style=position:absolute;left:74.41px;top:179.69px class=cls_008><span class=cls_008>到达的点为</span><span class=cls_009> (</span><span class=cls_014>n −</span><span class=cls_009> 1</span><span class=cls_014>, n</span><span class=cls_009> + 1)</span></div> <div style=position:absolute;left:98.32px;top:198.47px class=cls_008><span class=cls_008>我们会发现任何一种非法方案都可以对称成</span><span class=cls_009> (0</span><span class=cls_014>,</span><span class=cls_009> 0) </span><span class=cls_008>到</span><span class=cls_009> (</span><span class=cls_014>n −</span><span class=cls_009> 1</span><span class=cls_014>, n</span><span class=cls_009> + 1) </span><span class=cls_008>的一条路径</span><span class=cls_009>, </span><span class=cls_008>他</span></div> <div style=position:absolute;left:300.65px;top:207.56px class=cls_009><span class=cls_009>(</span><span class=cls_016>2</span><span class=cls_015>n</span><span class=cls_009>)</span></div> <div style=position:absolute;left:335.59px;top:207.56px class=cls_009><span class=cls_009>(</span><span class=cls_016>2</span><span class=cls_015>n</span> </div> <div style=position:absolute;left:357.03px;top:207.56px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:74.41px;top:217.25px class=cls_008><span class=cls_008>们之间存在一一映射关系</span><span class=cls_009>, </span><span class=cls_008>所以总方案数是</span> </div> <div style=position:absolute;left:323.64px;top:217.25px class=cls_014><span class=cls_014>−</span> </div> <div style=position:absolute;left:308.25px;top:225.35px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:341.07px;top:225.35px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span></div> <div style=position:absolute;left:98.32px;top:236.03px class=cls_008><span class=cls_008>化简上面这个式子</span> </div> <div style=position:absolute;left:311.56px;top:256.73px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:334.97px;top:256.73px class=cls_009><span class=cls_009>(</span> </div> <div style=position:absolute;left:371.03px;top:256.73px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:289.92px;top:256.73px class=cls_009><span class=cls_009>(2</span><span class=cls_014>n</span></div> <div style=position:absolute;left:350.98px;top:265.50px class=cls_009><span class=cls_009>2</span><span class=cls_014>n</span></div> <div style=position:absolute;left:215.45px;top:273.59px class=cls_014><span class=cls_014>Catalan</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009>) =</span></div> <div style=position:absolute;left:323.02px;top:273.59px class=cls_014><span class=cls_014>−</span> </div> <div style=position:absolute;left:301.64px;top:281.79px class=cls_014><span class=cls_014>n</span> </div> <div style=position:absolute;left:343.77px;top:281.79px class=cls_014><span class=cls_014>n</span><span class=cls_009>+1</span></div> <div style=position:absolute;left:163.58px;top:302.38px class=cls_016><span class=cls_016>(2</span><span class=cls_015>n</span><span class=cls_016>)!</span> </div> <div style=position:absolute;left:98.32px;top:302.38px class=cls_009><span class=cls_009>=</span><span class=cls_016> </span><span class=cls_026>(2</span><span class=cls_025>n</span><span class=cls_026>)!</span> </div> <div style=position:absolute;left:134.69px;top:304.09px class=cls_014><span class=cls_014>−</span> </div> <div style=position:absolute;left:114.19px;top:312.20px class=cls_015><span class=cls_015>n</span><span class=cls_016>!</span><span class=cls_015>n</span><span class=cls_016>!</span></div> <div style=position:absolute;left:147.84px;top:312.20px class=cls_016><span class=cls_016>(</span><span class=cls_015>n</span><span class=cls_016>+1)!(</span><span class=cls_015>n−</span><span class=cls_016>1)!</span></div> <div style=position:absolute;left:98.32px;top:322.15px class=cls_009><span class=cls_009>=</span><span class=cls_026><sup>1</sup></span></div> <div style=position:absolute;left:176.24px;top:321.16px class=cls_014><span class=cls_014>−</span><span class=cls_016> </span><span class=cls_026> (2</span><span class=cls_025>n</span><span class=cls_026>)!</span></div> <div style=position:absolute;left:108.63px;top:321.16px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span><span class=cls_009> (</span><span class=cls_016>(2</span><span class=cls_015>nn</span><span class=cls_016>!!</span> </div> <div style=position:absolute;left:157.09px;top:330.98px class=cls_016><span class=cls_016>!</span> </div> <div style=position:absolute;left:189.39px;top:322.87px class=cls_015><span class=cls_015>n</span><span class=cls_016>!(</span><span class=cls_015>n−</span><span class=cls_016>1)!</span><span class=cls_009> )</span> </div> <div style=position:absolute;left:98.32px;top:340.93px class=cls_009><span class=cls_009>=</span><span class=cls_026><sup>1</sup></span></div> <div style=position:absolute;left:180.13px;top:339.94px class=cls_014><span class=cls_014>−</span><span class=cls_026>(2</span><span class=cls_025>n</span><span class=cls_026>)!</span><span class=cls_025>∗n</span> </div> <div style=position:absolute;left:112.52px;top:339.94px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span><span class=cls_009> (</span><span class=cls_016>(2</span><span class=cls_015>nn</span><span class=cls_016>!!</span> </div> <div style=position:absolute;left:160.99px;top:349.76px class=cls_016><span class=cls_016>!</span> </div> <div style=position:absolute;left:199.64px;top:349.76px class=cls_015><span class=cls_015>n</span><span class=cls_016>!</span><span class=cls_015>n</span><span class=cls_016>!</span></div> <div style=position:absolute;left:98.32px;top:358.72px class=cls_009><span class=cls_009>=</span><span class=cls_026>1(2</span><span class=cls_025>n</span><span class=cls_026>)!(</span><span class=cls_025>n</span><span class=cls_026>+1)</span><span class=cls_025>−</span><span class=cls_026>(2</span><span class=cls_025>n</span><span class=cls_026>)!</span><span class=cls_025>∗n</span> </div> <div style=position:absolute;left:112.52px;top:368.54px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span></div> <div style=position:absolute;left:160.95px;top:368.54px class=cls_015><span class=cls_015>n</span><span class=cls_016>!</span><span class=cls_015>n</span><span class=cls_016>!</span></div> <div style=position:absolute;left:98.32px;top:377.50px class=cls_009><span class=cls_009>=</span><span class=cls_026>1(2</span><span class=cls_025>n</span><span class=cls_026>)!</span></div> <div style=position:absolute;left:112.52px;top:387.32px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span><span class=cls_015> n</span><span class=cls_016>!</span><span class=cls_015>n</span><span class=cls_016>!</span></div> <div style=position:absolute;left:129.68px;top:388.31px class=cls_009><span class=cls_009>(</span><span class=cls_016>2</span><span class=cls_015>n</span><span class=cls_009>)</span></div> <div style=position:absolute;left:98.32px;top:397.27px class=cls_009><span class=cls_009>=</span><span class=cls_026><sup>1</sup></span></div> <div style=position:absolute;left:112.52px;top:406.10px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span></div> <div style=position:absolute;left:137.27px;top:406.10px class=cls_015><span class=cls_015>n</span> </div> <div style=position:absolute;left:74.41px;top:433.52px class=cls_012><span class=cls_012>5.3.1</span> </div> <div style=position:absolute;left:114.04px;top:433.52px class=cls_008><span class=cls_008>卡特兰数的其他形式</span> </div> <div style=position:absolute;left:160.28px;top:451.06px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:175.43px;top:450.34px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span><span class=cls_016><sub>2</sub></span></div> <div style=position:absolute;left:146.45px;top:459.30px class=cls_027><span class=cls_027>1</span> </div> <div style=position:absolute;left:98.32px;top:460.02px class=cls_014><span class=cls_014>C</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009>) =</span></div> <div style=position:absolute;left:140.59px;top:468.13px class=cls_015><span class=cls_015>n</span><span class=cls_016>+1</span></div> <div style=position:absolute;left:182.04px;top:468.13px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:159.73px;top:474.26px class=cls_015><span class=cls_015>i</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:160.21px;top:479.48px class=cls_009><span class=cls_009>∑</span> </div> <div style=position:absolute;left:98.32px;top:488.45px class=cls_014><span class=cls_014>C</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009> + 1) =</span><span class=cls_014> C</span><span class=cls_009>(</span><span class=cls_014>i</span><span class=cls_009>)</span><span class=cls_014>C</span><span class=cls_009>(</span><span class=cls_014>n − i</span><span class=cls_009>)</span><span class=cls_014>, C</span><span class=cls_009>(0) = 1</span></div> <div style=position:absolute;left:159.66px;top:502.69px class=cls_015><span class=cls_015>i</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:98.32px;top:510.86px class=cls_014><span class=cls_014>C</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009> + 1) =</span><span class=cls_026>2(2</span><span class=cls_025>n</span><span class=cls_026>+1)</span><span class=cls_014>C</span><span class=cls_009>(</span><span class=cls_014>n</span><span class=cls_009>)</span><span class=cls_014>, C</span><span class=cls_009>(0) = 1</span></div> <div style=position:absolute;left:168.39px;top:520.68px class=cls_015><span class=cls_015>n</span><span class=cls_016>+2</span></div> <div style=position:absolute;left:74.41px;top:548.09px class=cls_012><span class=cls_012>5.3.2</span> </div> <div style=position:absolute;left:114.04px;top:548.09px class=cls_008><span class=cls_008>卡特兰数的一些应用</span><span class=cls_012> (</span><span class=cls_008>信息学中初赛经常常用到</span><span class=cls_012>)</span></div> <div style=position:absolute;left:89.21px;top:574.60px class=cls_009><span class=cls_009>1. n </span><span class=cls_008>对括号的合法匹配的方案数</span></div> <div style=position:absolute;left:89.21px;top:603.35px class=cls_009><span class=cls_009>2. n </span><span class=cls_008>个节点二叉树的形态数</span></div> <div style=position:absolute;left:89.21px;top:632.09px class=cls_009><span class=cls_009>3. n+1 </span><span class=cls_008>个叶子</span><span class=cls_009> (n </span><span class=cls_008>个非叶节点</span><span class=cls_009>) </span><span class=cls_008>的满二叉树</span><span class=cls_009>（</span><span class=cls_008>每个节点都有两个儿子或者没有儿子</span><span class=cls_009>）</span> </div> <div style=position:absolute;left:104.30px;top:650.87px class=cls_008><span class=cls_008>的形态数</span><span class=cls_009>, </span><span class=cls_008>走到左儿子</span><span class=cls_009> +1, </span><span class=cls_008>走到右儿子</span><span class=cls_009>-1, </span><span class=cls_008>类似于括号匹配</span><span class=cls_009>.2 , 3 </span><span class=cls_008>两种情况其实是</span></div> <div style=position:absolute;left:104.30px;top:669.65px class=cls_008><span class=cls_008>一回事</span></div> <div style=position:absolute;left:89.21px;top:698.39px class=cls_009><span class=cls_009>4. n </span><span class=cls_008>个数入栈后出栈的排列总数</span></div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>12</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:10212px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background13.jpg width=595 height=841></div> <div style=position:absolute;left:431.32px;top:44.59px class=cls_009><span class=cls_009>6</span> </div> <div style=position:absolute;left:449.14px;top:44.59px class=cls_008><span class=cls_008>放球问题汇总</span> </div> <div style=position:absolute;left:89.21px;top:85.79px class=cls_009><span class=cls_009>5. </span><span class=cls_008>对凸</span><span class=cls_009> n+2 </span><span class=cls_008>边形进行不同的三角形分割的方案数</span><span class=cls_009>, </span><span class=cls_008>分割点不能交叉</span><span class=cls_009>, </span><span class=cls_008>可以在端点处</span></div> <div style=position:absolute;left:104.30px;top:104.57px class=cls_008><span class=cls_008>相交</span></div> <div style=position:absolute;left:104.30px;top:265.94px class=cls_008><span class=cls_008>选择一条基础边</span><span class=cls_009>, </span><span class=cls_008>中间的三角形将整个多边形劈开两半</span><span class=cls_009>, </span><span class=cls_008>变成了两个子问题</span><span class=cls_009>, </span><span class=cls_008>就可</span></div> <div style=position:absolute;left:104.30px;top:284.72px class=cls_008><span class=cls_008>以用卡特兰数的其他形式中的第二种形式来做了</span><span class=cls_009>.</span></div> <div style=position:absolute;left:74.41px;top:325.99px class=cls_006><span class=cls_006>6</span> </div> <div style=position:absolute;left:101.32px;top:325.99px class=cls_007><span class=cls_007>放球问题汇总</span> </div> <div style=position:absolute;left:98.32px;top:361.88px class=cls_014><span class=cls_014>n</span><span class=cls_008> 个球放到</span><span class=cls_014> m</span><span class=cls_009> </span><span class=cls_008>个盒子里</span></div> <div style=position:absolute;left:74.41px;top:399.55px class=cls_017><span class=cls_017>6.1</span></div> <div style=position:absolute;left:109.40px;top:399.55px class=cls_004><span class=cls_004>球相同</span><span class=cls_017>, </span><span class=cls_004>盒相同</span><span class=cls_017>, </span><span class=cls_004>可以为空</span></div> <div style=position:absolute;left:98.32px;top:428.45px class=cls_008><span class=cls_008>等价于整数拆分问题</span><span class=cls_009>，</span><span class=cls_008>比如将</span><span class=cls_009> 7 </span><span class=cls_008>拆分成小于等于</span><span class=cls_009> 3 </span><span class=cls_008>个数的方案有</span><span class=cls_009> [1,1,5], [1,2,4],</span></div> <div style=position:absolute;left:74.41px;top:447.23px class=cls_009><span class=cls_009>[1,6] </span><span class=cls_008>等</span><span class=cls_009>，</span><span class=cls_008>注意</span><span class=cls_009>，</span><span class=cls_008>由于盒子是相同的</span><span class=cls_009>，</span><span class=cls_008>所以</span><span class=cls_009> [1,1,5] </span><span class=cls_008>和</span><span class=cls_009> [1,5,1] </span><span class=cls_008>是同一种方案</span></div> <div style=position:absolute;left:98.32px;top:466.01px class=cls_008><span class=cls_008>我们可以用</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>] </span><span class=cls_008>表示</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>个球放到</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>个盒子里的方案数</span></div> <div style=position:absolute;left:98.32px;top:484.79px class=cls_008><span class=cls_008>转移方程为</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>] =</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j −</span><span class=cls_009> 1] +</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i − j</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>]</span> </div> <div style=position:absolute;left:98.32px;top:503.57px class=cls_008><span class=cls_008>两种转移分别表示</span> </div> <div style=position:absolute;left:98.32px;top:522.35px class=cls_009><span class=cls_009>1: </span><span class=cls_008>放入小球后</span><span class=cls_009>，</span><span class=cls_008>球最少的盒子为空</span><span class=cls_009>，</span><span class=cls_008>相当于将</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>个小球放入</span><span class=cls_014> j−</span><span class=cls_009>1 </span><span class=cls_008>个盒子里</span><span class=cls_009>，</span><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j−</span> </div> <div style=position:absolute;left:74.41px;top:541.13px class=cls_009><span class=cls_009>1]</span> </div> <div style=position:absolute;left:98.32px;top:559.90px class=cls_009><span class=cls_009>2: </span><span class=cls_008>放入小球后</span><span class=cls_009>，</span><span class=cls_008>球最少的盒子不为空</span><span class=cls_009>，</span><span class=cls_008>说明每个盒子里面都有球</span><span class=cls_009>，</span><span class=cls_008>可以从</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i−j</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>]</span> </div> <div style=position:absolute;left:74.41px;top:578.68px class=cls_008><span class=cls_008>转移过来</span></div> <div style=position:absolute;left:98.32px;top:597.46px class=cls_008><span class=cls_008>关于整数拆分的延伸阅读</span></div> <div style=position:absolute;left:98.32px;top:616.24px class=cls_009><span class=cls_009> </span><a href=http://www.matrix67.com/blog/archives/6348/ >http://www.matrix67.com/blog/archives/6348</a> </div> <div style=position:absolute;left:74.41px;top:653.91px class=cls_017><span class=cls_017>6.2</span></div> <div style=position:absolute;left:109.40px;top:653.91px class=cls_004><span class=cls_004>球相同</span><span class=cls_017>, </span><span class=cls_004>盒相同</span><span class=cls_017>, </span><span class=cls_004>不能为空</span></div> <div style=position:absolute;left:98.32px;top:682.81px class=cls_008><span class=cls_008>不能为空就可以利用上面整数拆分的结果</span><span class=cls_009>，dp[i][j] - dp[i][j-1]</span></div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>13</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:11063px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background14.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>6.3</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>球不同</span><span class=cls_009>, </span><span class=cls_008>盒不同</span><span class=cls_009>, </span><span class=cls_008>可以为空</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>组合数取模</span> </div> <div style=position:absolute;left:74.41px;top:83.40px class=cls_017><span class=cls_017>6.3</span> </div> <div style=position:absolute;left:109.40px;top:83.40px class=cls_004><span class=cls_004>球不同</span><span class=cls_017>, </span><span class=cls_004>盒不同</span><span class=cls_017>, </span><span class=cls_004>可以为空</span></div> <div style=position:absolute;left:98.32px;top:112.30px class=cls_008><span class=cls_008>每个球都有</span><span class=cls_014> m</span><span class=cls_009> </span><span class=cls_008>种不同的选择</span></div> <div style=position:absolute;left:98.32px;top:130.72px class=cls_008><span class=cls_008>答案为</span><span class=cls_014> n</span><span class=cls_015><sup>m</sup></span></div> <div style=position:absolute;left:74.41px;top:167.94px class=cls_017><span class=cls_017>6.4</span></div> <div style=position:absolute;left:109.40px;top:167.94px class=cls_004><span class=cls_004>球不同</span><span class=cls_017>, </span><span class=cls_004>盒相同</span><span class=cls_017>, </span><span class=cls_004>不能为空</span></div> <div style=position:absolute;left:98.32px;top:196.84px class=cls_014><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>], </span><span class=cls_008>将</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>个球放入</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>个盒子里的方案数</span></div> <div style=position:absolute;left:98.32px;top:215.62px class=cls_008><span class=cls_008>当前这个球一种选择是放入之前的某个盒子</span><span class=cls_009>，</span><span class=cls_008>虽然盒子是相同的</span><span class=cls_009>，</span><span class=cls_008>但是因为球是</span></div> <div style=position:absolute;left:74.41px;top:234.40px class=cls_008><span class=cls_008>不同的导致当前这个球放入这</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>个盒子的某一个有</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>种选择</span></div> <div style=position:absolute;left:98.32px;top:253.18px class=cls_008><span class=cls_008>另一种选择是不放入之前的盒子</span><span class=cls_009>，</span><span class=cls_008>放入一个新盒子</span> </div> <div style=position:absolute;left:98.32px;top:271.96px class=cls_014><span class=cls_014>dp</span><span class=cls_009>[</span><span class=cls_014>i</span><span class=cls_009>][</span><span class=cls_014>j</span><span class=cls_009>] =</span><span class=cls_014> j ∗ dp</span><span class=cls_009>[</span><span class=cls_014>i −</span><span class=cls_009> 1][</span><span class=cls_014>j</span><span class=cls_009>] +</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>i −</span><span class=cls_009> 1][</span><span class=cls_014>j −</span><span class=cls_009> 1]</span></div> <div style=position:absolute;left:98.32px;top:290.74px class=cls_008><span class=cls_008>所以这个本质上就是第二类斯特林数</span><span class=cls_009>，</span><span class=cls_008>等价于将</span><span class=cls_014> i</span><span class=cls_009> </span><span class=cls_008>个不同的小球分成了</span><span class=cls_014> j</span><span class=cls_009> </span><span class=cls_008>个非空</span></div> <div style=position:absolute;left:74.41px;top:309.52px class=cls_008><span class=cls_008>集合的方案数</span> </div> <div style=position:absolute;left:74.41px;top:346.38px class=cls_017><span class=cls_017>6.5</span></div> <div style=position:absolute;left:109.40px;top:346.38px class=cls_004><span class=cls_004>球不同</span><span class=cls_017>, </span><span class=cls_004>盒不同</span><span class=cls_017>, </span><span class=cls_004>不能为空</span></div> <div style=position:absolute;left:98.32px;top:375.28px class=cls_008><span class=cls_008>先假设盒子都是相同的</span><span class=cls_009>，</span><span class=cls_008>问题就转换成了前一个问题</span><span class=cls_009>，</span><span class=cls_008>最后因为盒子不同</span><span class=cls_009>，</span><span class=cls_008>所以</span></div> <div style=position:absolute;left:74.41px;top:394.06px class=cls_008><span class=cls_008>任意一种排列都是不同的。</span></div> <div style=position:absolute;left:98.32px;top:412.84px class=cls_008><span class=cls_008>答案等于</span><span class=cls_014> dp</span><span class=cls_009>[</span><span class=cls_014>n</span><span class=cls_009>][</span><span class=cls_014>m</span><span class=cls_009>]</span><span class=cls_014> ∗ m</span><span class=cls_009>!</span> </div> <div style=position:absolute;left:74.41px;top:449.70px class=cls_017><span class=cls_017>6.6</span></div> <div style=position:absolute;left:109.40px;top:449.70px class=cls_004><span class=cls_004>球不同</span><span class=cls_017>, </span><span class=cls_004>盒相同</span><span class=cls_017>, </span><span class=cls_004>可以为空</span></div> <div style=position:absolute;left:98.32px;top:478.60px class=cls_008><span class=cls_008>还是跟第二类斯特林数一样</span><span class=cls_009>，</span><span class=cls_008>可以为空就相当于枚举一下最终用了几个盒子求和</span></div> <div style=position:absolute;left:74.41px;top:497.38px class=cls_008><span class=cls_008>即可</span> </div> <div style=position:absolute;left:74.41px;top:534.24px class=cls_017><span class=cls_017>6.7</span></div> <div style=position:absolute;left:109.40px;top:534.24px class=cls_004><span class=cls_004>球相同</span><span class=cls_017>, </span><span class=cls_004>盒不同</span><span class=cls_017>, </span><span class=cls_004>不能为空</span></div> <div style=position:absolute;left:182.01px;top:553.45px class=cls_009><span class=cls_009>(</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:98.32px;top:563.14px class=cls_008><span class=cls_008>经典的隔板法</span><span class=cls_009>，</span></div> <div style=position:absolute;left:187.49px;top:571.25px class=cls_015><span class=cls_015>m−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:74.41px;top:600.00px class=cls_017><span class=cls_017>6.8</span></div> <div style=position:absolute;left:109.40px;top:600.00px class=cls_004><span class=cls_004>球相同</span><span class=cls_017>, </span><span class=cls_004>盒不同</span><span class=cls_017>, </span><span class=cls_004>可以为空</span></div> <div style=position:absolute;left:98.32px;top:619.22px class=cls_009><span class=cls_009>(</span><span class=cls_015>m</span><span class=cls_016>+</span><span class=cls_015>n−</span><span class=cls_016>1</span><span class=cls_009>)</span></div> <div style=position:absolute;left:110.84px;top:637.01px class=cls_015><span class=cls_015>n−</span><span class=cls_016>1</span></div> <div style=position:absolute;left:74.41px;top:669.36px class=cls_006><span class=cls_006>7</span> </div> <div style=position:absolute;left:101.32px;top:669.36px class=cls_007><span class=cls_007>组合数取模</span> </div> <div style=position:absolute;left:114.17px;top:695.57px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:98.32px;top:705.25px class=cls_008><span class=cls_008>求</span> </div> <div style=position:absolute;left:137.93px;top:705.25px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:119.65px;top:713.36px class=cls_015><span class=cls_015>m</span> </div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>14</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:11914px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background15.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>7.1</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>第一阶段</span><span class=cls_009>-</span><span class=cls_008>普通阶乘逆元</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>组合数取模</span> </div> <div style=position:absolute;left:74.41px;top:83.40px class=cls_017><span class=cls_017>7.1</span> </div> <div style=position:absolute;left:109.40px;top:83.40px class=cls_004><span class=cls_004>第一阶段</span><span class=cls_017>-</span><span class=cls_004>普通阶乘逆元</span></div> <div style=position:absolute;left:98.32px;top:112.30px class=cls_008><span class=cls_008>数据范围</span><span class=cls_009>：</span><span class=cls_014>n, m ≤</span><span class=cls_009> 1</span><span class=cls_014>e</span><span class=cls_009>6</span> </div> <div style=position:absolute;left:98.32px;top:131.08px class=cls_014><span class=cls_014>p</span><span class=cls_008> 是质数</span><span class=cls_009>，</span><span class=cls_008>直接利用阶乘逆元</span><span class=cls_009>，</span><span class=cls_008>费马小定理搞定</span></div> <div style=position:absolute;left:74.41px;top:168.75px class=cls_017><span class=cls_017>7.2</span></div> <div style=position:absolute;left:109.40px;top:168.75px class=cls_004><span class=cls_004>第二阶段</span><span class=cls_017>-</span><span class=cls_004>卢卡斯定理</span></div> <div style=position:absolute;left:98.32px;top:197.64px class=cls_008><span class=cls_008>数据范围</span><span class=cls_009>：</span><span class=cls_014>n, m ≤</span><span class=cls_009> 1</span><span class=cls_014>e</span><span class=cls_009>18,</span><span class=cls_014> p</span><span class=cls_009> </span><span class=cls_008>是质数</span><span class=cls_014> p ≤</span><span class=cls_009> 1</span><span class=cls_014>e</span><span class=cls_009>6</span></div> <div style=position:absolute;left:74.41px;top:233.17px class=cls_012><span class=cls_012>7.2.1</span> </div> <div style=position:absolute;left:114.04px;top:233.17px class=cls_008><span class=cls_008>定理描述</span> </div> <div style=position:absolute;left:98.32px;top:259.68px class=cls_008><span class=cls_008>首先</span><span class=cls_009>，</span><span class=cls_008>我们将</span><span class=cls_014> n, m</span><span class=cls_009> </span><span class=cls_008>写成</span><span class=cls_014> p</span><span class=cls_009> </span><span class=cls_008>进制数的形式</span></div> <div style=position:absolute;left:98.32px;top:278.46px class=cls_014><span class=cls_014>n </span><span class=cls_009>= (</span><span class=cls_014>a</span><span class=cls_016><sub>0</sub></span><span class=cls_014>a</span><span class=cls_016><sub>1</sub></span><span class=cls_014>...a</span><span class=cls_015><sub>k</sub></span><span class=cls_009>)</span><span class=cls_015><sub>p</sub></span></div> <div style=position:absolute;left:98.32px;top:297.24px class=cls_014><span class=cls_014>m </span><span class=cls_009>= (</span><span class=cls_014>b</span><span class=cls_016><sub>0</sub></span><span class=cls_014>b</span><span class=cls_016><sub>1</sub></span><span class=cls_014>...b</span><span class=cls_015><sub>k</sub></span><span class=cls_009>)</span><span class=cls_015><sub>p</sub></span></div> <div style=position:absolute;left:98.32px;top:316.02px class=cls_008><span class=cls_008>那么</span> </div> <div style=position:absolute;left:270.81px;top:329.39px class=cls_009><span class=cls_009>∏</span> </div> <div style=position:absolute;left:288.08px;top:323.89px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>a</span><span class=cls_015><sub>i</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:327.16px;top:340.75px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:235.83px;top:340.75px class=cls_014><span class=cls_014>m ≡</span></div> <div style=position:absolute;left:297.46px;top:348.95px class=cls_014><span class=cls_014>b</span><span class=cls_015><sub>i</sub></span></div> <div style=position:absolute;left:271.60px;top:358.57px class=cls_015><span class=cls_015>i</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:98.32px;top:372.59px class=cls_008><span class=cls_008>也可以用递归的形式来表示这个式子</span></div> <div style=position:absolute;left:207.71px;top:393.29px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:251.49px;top:393.29px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014> n</span><span class=cls_009>%</span><span class=cls_014>p</span><span class=cls_009><sup>)(</sup></span><span class=cls_014> n</span><span class=cls_009>/</span><span class=cls_014>p</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:346.48px;top:410.15px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:216.51px;top:410.15px class=cls_014><span class=cls_014>m ≡</span></div> <div style=position:absolute;left:260.29px;top:418.35px class=cls_014><span class=cls_014>m</span><span class=cls_009>%</span><span class=cls_014>p m</span><span class=cls_009>/</span><span class=cls_014>p</span></div> <div style=position:absolute;left:98.32px;top:438.31px class=cls_008><span class=cls_008>我们发现如果上面的这个式子成立的话</span><span class=cls_009>，</span><span class=cls_008>我们就可以一直递归到</span><span class=cls_014> n &lt; p,m &lt; p</span><span class=cls_009> </span><span class=cls_008>的</span></div> <div style=position:absolute;left:74.41px;top:457.09px class=cls_008><span class=cls_008>时候再进行计算</span> </div> <div style=position:absolute;left:74.41px;top:492.62px class=cls_012><span class=cls_012>7.2.2</span> </div> <div style=position:absolute;left:114.04px;top:492.62px class=cls_008><span class=cls_008>定理证明</span> </div> <div style=position:absolute;left:98.32px;top:519.13px class=cls_008><span class=cls_008>首先介绍一个引理</span><span class=cls_009>:</span></div> <div style=position:absolute;left:225.92px;top:555.73px class=cls_009><span class=cls_009>(</span><span class=cls_014>a</span><span class=cls_009> +</span><span class=cls_014> b</span><span class=cls_009>)</span><span class=cls_015><sup>p</sup></span><span class=cls_014> ≡ a</span><span class=cls_015><sup>p</sup></span><span class=cls_009> +</span><span class=cls_014> b</span><span class=cls_015><sup>p</sup></span></div> <div style=position:absolute;left:328.28px;top:556.69px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:98.32px;top:581.59px class=cls_008><span class=cls_008>证明</span><span class=cls_009>：</span><span class=cls_008>根据费马小定理</span><span class=cls_009> (</span><span class=cls_014>a</span><span class=cls_009> +</span><span class=cls_014> b</span><span class=cls_009>)</span><span class=cls_015><sup>p</sup></span><span class=cls_014> ≡ a</span><span class=cls_009> +</span><span class=cls_014> b ≡ a</span><span class=cls_015><sup>p</sup></span><span class=cls_009> +</span><span class=cls_014> b</span><span class=cls_015><sup>p</sup></span><span class=cls_009> (mod</span><span class=cls_014> p</span><span class=cls_009>)</span></div> <div style=position:absolute;left:98.32px;top:600.72px class=cls_008><span class=cls_008>因此</span> </div> <div style=position:absolute;left:226.91px;top:637.33px class=cls_009><span class=cls_009>(1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>p</sup></span><span class=cls_014> ≡</span><span class=cls_009> 1 +</span><span class=cls_014> x</span><span class=cls_015><sup>p</sup></span></div> <div style=position:absolute;left:327.28px;top:638.28px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:98.32px;top:663.53px class=cls_008><span class=cls_008>假设</span><span class=cls_014> n</span><span class=cls_009>%</span><span class=cls_014>p</span><span class=cls_009> =</span><span class=cls_014> b</span></div> <div style=position:absolute;left:194.59px;top:698.24px class=cls_009><span class=cls_009>(1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_014> ≡</span><span class=cls_009> (1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015>⌊</span><span class=cls_024>p</span><span class=cls_015> ⌋p</span><span class=cls_009>(1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>b</sup></span></div> <div style=position:absolute;left:359.61px;top:701.09px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>15</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span></div> <div style=position:absolute;left:449.14px;top:735.14px class=cls_008><span class=cls_008>编程内部讲义</span> </div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:12765px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background16.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>7.3</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>第三阶段</span><span class=cls_009>-</span><span class=cls_008>中国剩余定理合并</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>组合数取模</span> </div> <div style=position:absolute;left:216.83px;top:101.71px class=cls_014><span class=cls_014>≡</span><span class=cls_009> (1 +</span><span class=cls_014> x</span><span class=cls_015><sup>p</sup></span><span class=cls_009>)</span><span class=cls_015>⌊</span><span class=cls_024>p</span><span class=cls_015> ⌋</span><span class=cls_009>(1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>b</sup></span></div> <div style=position:absolute;left:337.36px;top:104.57px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:98.32px;top:129.82px class=cls_008><span class=cls_008>二项式展开后变成如下式子</span></div> <div style=position:absolute;left:235.28px;top:154.42px class=cls_009><span class=cls_009>∑(</span><span class=cls_014>⌊</span><span class=cls_028>n</span> </div> <div style=position:absolute;left:306.58px;top:154.42px class=cls_009><span class=cls_009>∑(</span><span class=cls_014>b</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:270.29px;top:154.42px class=cls_015><span class=cls_015>p</span><span class=cls_014>⌋</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:290.30px;top:170.32px class=cls_014><span class=cls_014>x</span><span class=cls_015><sup>pi</sup></span></div> <div style=position:absolute;left:270.42px;top:179.76px class=cls_014><span class=cls_014>i</span> </div> <div style=position:absolute;left:334.65px;top:170.32px class=cls_014><span class=cls_014>j x</span><span class=cls_015><sup>j</sup></span></div> <div style=position:absolute;left:237.06px;top:189.10px class=cls_015><span class=cls_015>i</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:307.87px;top:189.10px class=cls_015><span class=cls_015>j</span><span class=cls_016>=0</span></div> <div style=position:absolute;left:98.32px;top:204.32px class=cls_008><span class=cls_008>注意这个式子与</span><span class=cls_009> (1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> </span><span class=cls_008>的展开是等价的</span><span class=cls_009>, </span><span class=cls_008>我们观察对于某一个</span><span class=cls_014> x</span><span class=cls_015><sup>m</sup></span><span class=cls_009> </span><span class=cls_008>的系数</span><span class=cls_009>，</span><span class=cls_008>在</span> </div> <div style=position:absolute;left:160.38px;top:213.77px class=cls_009><span class=cls_009>(</span><span class=cls_015><sub>n</sub></span><span class=cls_009>)</span></div> <div style=position:absolute;left:74.41px;top:223.10px class=cls_009><span class=cls_009>(1 +</span><span class=cls_014> x</span><span class=cls_009>)</span><span class=cls_015><sup>n</sup></span><span class=cls_009> </span><span class=cls_008>里面是</span></div> <div style=position:absolute;left:182.89px;top:223.10px class=cls_008><span class=cls_008>而在上面这个式子中</span><span class=cls_014> x</span><span class=cls_015><sup>m</sup></span><span class=cls_009> </span><span class=cls_008>被分成了两个部分</span><span class=cls_009>，</span><span class=cls_008>假设</span><span class=cls_014> m</span><span class=cls_009> =</span><span class=cls_014> i ∗ p</span><span class=cls_009> +</span><span class=cls_014> j</span><span class=cls_009>.</span></div> <div style=position:absolute;left:165.86px;top:231.56px class=cls_015><span class=cls_015>m</span> </div> <div style=position:absolute;left:74.41px;top:242.24px class=cls_009><span class=cls_009>(</span><span class=cls_014>j &lt; p</span><span class=cls_009>), </span><span class=cls_008>所以有</span></div> <div style=position:absolute;left:192.45px;top:262.94px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:236.04px;top:262.94px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>⌊</span><span class=cls_025><sup>n</sup></span></div> <div style=position:absolute;left:251.78px;top:262.94px class=cls_015><span class=cls_015>p</span><span class=cls_014>⌋</span><span class=cls_009>)(</span><span class=cls_014>b</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:294.91px;top:279.80px class=cls_009><span class=cls_009>(</span><span class=cls_014>m</span><span class=cls_009> =</span><span class=cls_014> i ∗ p</span><span class=cls_009> +</span><span class=cls_014> j, j &lt; p</span><span class=cls_009>)</span></div> <div style=position:absolute;left:201.25px;top:279.80px class=cls_014><span class=cls_014>m</span><span class=cls_009> =</span></div> <div style=position:absolute;left:251.92px;top:288.28px class=cls_014><span class=cls_014>i</span> </div> <div style=position:absolute;left:280.60px;top:288.00px class=cls_014><span class=cls_014>j</span> </div> <div style=position:absolute;left:98.32px;top:307.18px class=cls_014><span class=cls_014>i</span><span class=cls_009>=</span><span class=cls_014>⌊</span><span class=cls_025><sup>m</sup></span></div> <div style=position:absolute;left:126.18px;top:307.90px class=cls_015><span class=cls_015>p</span><span class=cls_014> ⌋,b</span><span class=cls_009>=</span><span class=cls_014>n</span><span class=cls_009>%</span><span class=cls_014>p,j</span><span class=cls_009>=</span><span class=cls_014>m</span><span class=cls_009>%</span><span class=cls_014>p</span><span class=cls_009>,</span><span class=cls_008>所以有</span></div> <div style=position:absolute;left:235.05px;top:328.61px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:278.64px;top:328.61px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>⌊</span><span class=cls_025><sup>n</sup></span></div> <div style=position:absolute;left:295.56px;top:328.61px class=cls_015><span class=cls_015>p</span><span class=cls_014>⌋</span><span class=cls_009>)(</span><span class=cls_014>n</span><span class=cls_009>%</span><span class=cls_014>p</span><span class=cls_009>)</span> </div> <div style=position:absolute;left:243.85px;top:345.46px class=cls_014><span class=cls_014>m</span><span class=cls_009> =</span></div> <div style=position:absolute;left:287.44px;top:353.79px class=cls_014><span class=cls_014>⌊</span><span class=cls_025><sup>m</sup></span></div> <div style=position:absolute;left:325.55px;top:353.66px class=cls_014><span class=cls_014>m</span><span class=cls_009>%</span><span class=cls_014>p</span> </div> <div style=position:absolute;left:295.56px;top:354.51px class=cls_015><span class=cls_015>p</span><span class=cls_014> ⌋</span></div> <div style=position:absolute;left:98.32px;top:376.60px class=cls_008><span class=cls_008>复杂度为</span><span class=cls_014> O</span><span class=cls_009>(</span><span class=cls_014>log</span><span class=cls_015><sup>n</sup></span></div> <div style=position:absolute;left:178.84px;top:376.96px class=cls_015><span class=cls_015>p</span><span class=cls_009>)</span></div> <div style=position:absolute;left:267.75px;top:407.23px class=cls_008><span class=cls_008>卢卡斯定理</span> </div> <div style=position:absolute;left:74.41px;top:427.98px class=cls_019><span class=cls_019>int</span><span class=cls_020> binom(</span><span class=cls_019>int</span><span class=cls_020> n,</span><span class=cls_019> int</span><span class=cls_020> m) {</span></div> <div style=position:absolute;left:84.23px;top:445.59px class=cls_019><span class=cls_019>if</span><span class=cls_020> (n &lt; m)</span><span class=cls_019> return</span><span class=cls_020> 0;</span> </div> <div style=position:absolute;left:84.23px;top:463.21px class=cls_019><span class=cls_019>return</span><span class=cls_020> 1LL * fac[n] * inv(fac[m]) % md * inv(fac[n - m]) %</span></div> <div style=position:absolute;left:422.14px;top:463.21px class=cls_020><span class=cls_020>md;</span></div> <div style=position:absolute;left:74.41px;top:480.82px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:74.41px;top:516.05px class=cls_019><span class=cls_019>int</span><span class=cls_020> lucas(</span><span class=cls_019>int</span><span class=cls_020> n,</span><span class=cls_019> int</span><span class=cls_020> m) {</span></div> <div style=position:absolute;left:84.23px;top:533.66px class=cls_019><span class=cls_019>if</span><span class=cls_020> (m == 0)</span><span class=cls_019> return</span><span class=cls_020> 1;</span> </div> <div style=position:absolute;left:84.23px;top:551.28px class=cls_019><span class=cls_019>return</span><span class=cls_020> 1LL * lucas(n / md, m / md) * binom(n % md, m % md)</span></div> <div style=position:absolute;left:422.14px;top:551.28px class=cls_020><span class=cls_020>% md;</span> </div> <div style=position:absolute;left:74.41px;top:568.89px class=cls_020><span class=cls_020>}</span> </div> <div style=position:absolute;left:74.41px;top:619.30px class=cls_017><span class=cls_017>7.3</span></div> <div style=position:absolute;left:109.40px;top:619.30px class=cls_004><span class=cls_004>第三阶段</span><span class=cls_017>-</span><span class=cls_004>中国剩余定理合并</span></div> <div style=position:absolute;left:98.32px;top:647.85px class=cls_008><span class=cls_008>数据范围</span><span class=cls_009>：</span><span class=cls_014>n, m ≤</span><span class=cls_009> 10</span><span class=cls_016><sup>18</sup></span><span class=cls_014>, p ≤</span><span class=cls_009> 10</span><span class=cls_016><sup>6</sup></span><span class=cls_009> (</span><span class=cls_014>p</span><span class=cls_009> </span><span class=cls_008>不一定是质数</span><span class=cls_009>)</span></div> <div style=position:absolute;left:98.32px;top:665.63px class=cls_008><span class=cls_008>我们可以先将</span><span class=cls_014> p</span><span class=cls_009> </span><span class=cls_008>进行质因数分解</span><span class=cls_009>，</span><span class=cls_008>然后求组合数对于每个</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span></div> <div style=position:absolute;left:412.13px;top:666.98px class=cls_015><span class=cls_015>i</span><span class=cls_009> </span><span class=cls_008>取模的结果</span><span class=cls_009>，</span><span class=cls_008>最后</span></div> <div style=position:absolute;left:74.41px;top:685.76px class=cls_008><span class=cls_008>使用中国剩余定理进行答案的合并</span><span class=cls_009>, </span><span class=cls_008>于是</span><span class=cls_009>，</span><span class=cls_008>现在我们需要求</span></div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>16</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div> <div style=position:absolute;left:50%;margin-left:-297px;top:13616px;width:595px;height:841px;border-style:outset;overflow:hidden> <div style=position:absolute;left:0px;top:0px> <img src=https://cdn.jsdelivr.net/gh/PetrichorA/page-1322228f@0.0.0/background17.jpg width=595 height=841></div> <div style=position:absolute;left:74.41px;top:44.59px class=cls_009><span class=cls_009>7.3</span> </div> <div style=position:absolute;left:101.33px;top:44.59px class=cls_008><span class=cls_008>第三阶段</span><span class=cls_009>-</span><span class=cls_008>中国剩余定理合并</span></div> <div style=position:absolute;left:443.28px;top:44.59px class=cls_009><span class=cls_009>7</span> </div> <div style=position:absolute;left:461.09px;top:44.59px class=cls_008><span class=cls_008>组合数取模</span> </div> <div style=position:absolute;left:253.12px;top:87.71px class=cls_009><span class=cls_009><sup>(</sup></span><span class=cls_014>n</span><span class=cls_009><sup>)</sup></span></div> <div style=position:absolute;left:329.45px;top:103.22px class=cls_015><span class=cls_015>a</span><span class=cls_024><sub>i</sub></span></div> <div style=position:absolute;left:292.92px;top:104.57px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span></div> <div style=position:absolute;left:337.60px;top:104.57px class=cls_009><span class=cls_009>)</span> </div> <div style=position:absolute;left:329.45px;top:111.62px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:261.92px;top:112.77px class=cls_014><span class=cls_014>m</span> </div> <div style=position:absolute;left:98.32px;top:132.72px class=cls_008><span class=cls_008>将组合数写成阶乘的形式</span></div> <div style=position:absolute;left:292.52px;top:162.19px class=cls_014><span class=cls_014>n</span><span class=cls_009>!</span></div> <div style=position:absolute;left:268.80px;top:178.48px class=cls_014><span class=cls_014>m</span><span class=cls_009>!(</span><span class=cls_014>n − m</span><span class=cls_009>)!</span></div> <div style=position:absolute;left:98.32px;top:197.02px class=cls_008><span class=cls_008>由于分母可能包含质因子</span><span class=cls_014> p</span><span class=cls_015><sub>i</sub></span><span class=cls_009>, </span><span class=cls_008>于是不能直接求分母对</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span></div> <div style=position:absolute;left:409.73px;top:198.36px class=cls_008><span class=cls_008>的逆元</span><span class=cls_009>，</span><span class=cls_008>可以考虑将</span></div> <div style=position:absolute;left:395.52px;top:205.41px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:74.41px;top:216.42px class=cls_008><span class=cls_008>分子分母中包含的</span><span class=cls_014> p</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>全部提取出去</span><span class=cls_009>，</span><span class=cls_008>最后再乘回去所以现在最关键的就是要求</span><span class=cls_025>n</span><span class=cls_026>!</span> </div> <div style=position:absolute;left:510.74px;top:224.50px class=cls_015><span class=cls_015>p</span><span class=cls_024><sup>x</sup></span></div> <div style=position:absolute;left:515.00px;top:229.89px class=cls_024><span class=cls_024>i</span> </div> <div style=position:absolute;left:74.41px;top:234.58px class=cls_009><span class=cls_009>(mod</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span><span class=cls_009>), </span><span class=cls_008>即算出分子和分母的阶乘去除</span><span class=cls_014> p</span><span class=cls_015>i</span><span class=cls_009> </span><span class=cls_008>因子后对</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span></div> <div style=position:absolute;left:386.16px;top:235.92px class=cls_008><span class=cls_008>取模</span><span class=cls_009>，</span><span class=cls_008>去掉之后就可以正</span></div> <div style=position:absolute;left:110.94px;top:242.97px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:372.60px;top:242.97px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:74.41px;top:254.70px class=cls_008><span class=cls_008>常使用逆元</span> </div> <div style=position:absolute;left:98.32px;top:273.13px class=cls_008><span class=cls_008>接下来以</span><span class=cls_009> 19! (mod 3</span><span class=cls_016><sup>2</sup></span><span class=cls_009>) </span><span class=cls_008>为例</span></div> <div style=position:absolute;left:98.32px;top:292.26px class=cls_009><span class=cls_009>19! = 1</span><span class=cls_014> ∗</span><span class=cls_009> 2</span><span class=cls_014> ∗</span><span class=cls_009> 3</span><span class=cls_014>... ∗</span><span class=cls_009> 17</span><span class=cls_014> ∗</span><span class=cls_009> 18</span><span class=cls_014> ∗</span><span class=cls_009> 19</span></div> <div style=position:absolute;left:98.32px;top:311.04px class=cls_009><span class=cls_009>= 1 </span><span class=cls_014>∗ </span><span class=cls_009>2 </span><span class=cls_014>∗ </span><span class=cls_009>4 </span><span class=cls_014>∗ </span><span class=cls_009>5 </span><span class=cls_014>∗ </span><span class=cls_009>7 </span><span class=cls_014>∗ </span><span class=cls_009>8 </span><span class=cls_014>∗ </span><span class=cls_009>10 </span><span class=cls_014>∗ </span><span class=cls_009>11 </span><span class=cls_014>∗ </span><span class=cls_009>13 </span><span class=cls_014>∗ </span><span class=cls_009>14 </span><span class=cls_014>∗ </span><span class=cls_009>16 </span><span class=cls_014>∗ </span><span class=cls_009>17 </span><span class=cls_014>∗ </span><span class=cls_009>19 </span><span class=cls_014>∗ </span><span class=cls_009>(3 </span><span class=cls_014>∗ </span><span class=cls_009>6 </span><span class=cls_014>∗ </span><span class=cls_009>9 </span><span class=cls_014>∗ </span><span class=cls_009>12 </span><span class=cls_014>∗ </span><span class=cls_009>15 </span><span class=cls_014>∗ </span><span class=cls_009>18)</span></div> <div style=position:absolute;left:98.32px;top:329.47px class=cls_009><span class=cls_009>= (1</span><span class=cls_014> ∗</span><span class=cls_009> 2</span><span class=cls_014> ∗</span><span class=cls_009> 4</span><span class=cls_014> ∗</span><span class=cls_009> 5</span><span class=cls_014> ∗</span><span class=cls_009> 7</span><span class=cls_014> ∗</span><span class=cls_009> 8)</span><span class=cls_014> ∗</span><span class=cls_009> (10</span><span class=cls_014> ∗</span><span class=cls_009> 11</span><span class=cls_014> ∗</span><span class=cls_009> 13</span><span class=cls_014> ∗</span><span class=cls_009> 14</span><span class=cls_014> ∗</span><span class=cls_009> 16</span><span class=cls_014> ∗</span><span class=cls_009> 17)</span><span class=cls_014> ∗</span><span class=cls_009> 19</span><span class=cls_014> ∗</span><span class=cls_009> 3</span><span class=cls_016><sup>6</sup></span><span class=cls_014> ∗</span><span class=cls_009> (1</span><span class=cls_014> ∗</span><span class=cls_009> 2</span><span class=cls_014> ∗</span><span class=cls_009> 3</span><span class=cls_014> ∗</span><span class=cls_009> 4</span><span class=cls_014> ∗</span><span class=cls_009> 5</span><span class=cls_014> ∗</span><span class=cls_009> 6)</span></div> <div style=position:absolute;left:98.32px;top:348.25px class=cls_009><span class=cls_009>3</span><span class=cls_016><sup>6</sup></span><span class=cls_014> ∗</span><span class=cls_009> (1</span><span class=cls_014> ∗</span><span class=cls_009> 2</span><span class=cls_014> ∗</span><span class=cls_009> 3</span><span class=cls_014> ∗</span><span class=cls_009> 4</span><span class=cls_014> ∗</span><span class=cls_009> 5</span><span class=cls_014> ∗</span><span class=cls_009> 6) </span><span class=cls_008>相当于先提取出所有</span><span class=cls_014> p</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>的倍数</span><span class=cls_009>，</span><span class=cls_008>然后</span><span class=cls_009>, </span><span class=cls_008>每个数再提取出一</span></div> <div style=position:absolute;left:74.41px;top:367.38px class=cls_008><span class=cls_008>个 </span><span class=cls_014>p</span><span class=cls_015><sub>i</sub></span><span class=cls_009>, </span><span class=cls_008>最后变成</span><span class=cls_014> n</span><span class=cls_009>/</span><span class=cls_014>p</span><span class=cls_015><sub>i</sub></span><span class=cls_009> </span><span class=cls_008>的阶乘</span><span class=cls_009>，</span><span class=cls_008>这个可以递归求解</span></div> <div style=position:absolute;left:98.32px;top:384.81px class=cls_009><span class=cls_009>(1</span><span class=cls_014> ∗</span><span class=cls_009> 2</span><span class=cls_014> ∗</span><span class=cls_009> 4</span><span class=cls_014> ∗</span><span class=cls_009> 5</span><span class=cls_014> ∗</span><span class=cls_009> 7</span><span class=cls_014> ∗</span><span class=cls_009> 8) </span><span class=cls_008>与</span><span class=cls_009> (10</span><span class=cls_014> ∗</span><span class=cls_009> 11</span><span class=cls_014> ∗</span><span class=cls_009> 13</span><span class=cls_014> ∗</span><span class=cls_009> 14</span><span class=cls_014> ∗</span><span class=cls_009> 16</span><span class=cls_014> ∗</span><span class=cls_009> 17) </span><span class=cls_008>模</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span></div> <div style=position:absolute;left:374.35px;top:386.16px class=cls_015><span class=cls_015>i</span><span class=cls_009> </span><span class=cls_008>是相等的</span><span class=cls_009>，</span><span class=cls_008>说明有循环节</span><span class=cls_009>，</span></div> <div style=position:absolute;left:74.41px;top:404.94px class=cls_008><span class=cls_008>所以我们只需算出一个括号内的然后快速幂计算所有循环</span></div> <div style=position:absolute;left:98.32px;top:422.37px class=cls_008><span class=cls_008>最后剩下一部分零头的数量一定小于</span><span class=cls_014> p</span><span class=cls_015>a</span><span class=cls_024>i</span><span class=cls_009>,</span><span class=cls_008> 可以暴力计算</span></div> <div style=position:absolute;left:299.38px;top:430.77px class=cls_015><span class=cls_015>i</span> </div> <div style=position:absolute;left:291.78px;top:735.14px class=cls_009><span class=cls_009>17</span></div> <div style=position:absolute;left:427.02px;top:735.14px class=cls_014><span class=cls_014>517</span><span class=cls_009> </span><span class=cls_008>编程内部讲义</span></div> </div></body></html>